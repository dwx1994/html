System.register([], function(_export, _context) { return { execute: function () {
System.register("chunks:///Define.js",["cc"],(function(e,o){var t,r,h,n,u,i;return e({GameEnv:void 0,RoleSex:void 0,ResType:void 0,OperationType:void 0}),{setters:[function(e){t=e.cclegacy,r=e.Prefab}],execute:function(){t._RF.push({},"9548dQYDpJAHLsbsL2WfqMJ","Define",void 0),function(e){e[e.Debug=0]="Debug",e[e.ONLINE=1]="ONLINE"}(h||e("GameEnv",h={})),e("TableName",{Role:"role"}),e("EventName",{EVT_ADDBODY:"addBody",EVT_SUBBDOY:"subBody",EVT_BODYCHANGE:"bodyChange",EVT_BODYCOLORCHANGE:"bodyColorChange",EVT_GAMEINIT:"gameInit",EVT_BODYANIM:"bodyAnim",EVT_ARKIT:"arkit",EVT_CHANGEBG:"changeBg",EVT_CHANGESROLECALE:"changeRoleScale",EVT_SCREENSHOT:"screenshot",EVT_HOTUPDATE:"hotUpdate",EVT_GETGAMEDATA:"getGameData",EVT_CHANGEROLE:"changeRole",EVT_ROTATEROLE:"rotateRole",EVT_ALREADYUPTODATE:"alreadyUpToDate"}),e("SDKCallStaticMethodName",{onRoleSettingsCallback:"onRoleSettingsCallback"}),e("GameRes",[{url:"prefab/female_role_10002",type:r},{url:"prefab/male_role_10001",type:r},{url:"prefab/Layout",type:r}]),function(e){e[e.Girl=0]="Girl",e[e.Boy=1]="Boy",e[e.Both=2]="Both"}(n||e("RoleSex",n={})),e("FacePart",{cheekPuff:"cheekPuff",cheekSquint_L:"cheekSquintLeft",cheekSquint_R:"cheekSquintRight",eyeBlink_L:"eyeBlinkLeft",eyeBlink_R:"eyeBlinkRight",eyeLookDown_L:"eyeLookDownLeft",eyeLookDown_R:"eyeLookDownRight",eyeLookIn_L:"eyeLookInLeft",eyeLookIn_R:"eyeLookInRight",eyeLookOut_L:"eyeLookOutLeft",eyeLookOut_R:"eyeLookOutRight",eyeLookUp_L:"eyeLookUpLeft",eyeLookUp_R:"eyeLookUpRight",eyeSquint_L:"eyeSquintLeft",eyeSquint_R:"eyeSquintRight",eyeWide_L:"eyeWideLeft",eyeWide_R:"eyeWideRight",jawForward:"jawForward",jawLeft:"jawLeft",jawOpen:"jawOpen",jawRight:"jawRight",mouthClose:"mouthClose",mouthDimple_L:"mouthDimpleLeft",mouthDimple_R:"mouthDimpleRight",mouthFrown_L:"mouthFrownLeft",mouthFrown_R:"mouthFrownRight",mouthFunnel:"mouthFunnel",mouthLeft:"mouthLeft",mouthLowerDown_L:"mouthLowerDownLeft",mouthLowerDown_R:"mouthLowerDownRight",mouthPress_L:"mouthPressLeft",mouthPress_R:"mouthPressRight",mouthPucker:"mouthPucker",mouthRight:"mouthRight",mouthRollLower:"mouthRollLower",mouthRollUpper:"mouthRollUpper",mouthShrugLower:"mouthShrugLower",mouthShrugUpper:"mouthShrugUpper",mouthSmile_L:"mouthSmileLeft",mouthSmile_R:"mouthSmileRight",mouthStretch_L:"mouthStretchLeft",mouthStretch_R:"mouthStretchRight",mouthUpperUp_L:"mouthUpperUpLeft",mouthUpperUp_R:"mouthUpperUpRight",noseSneer_L:"noseSneerLeft",noseSneer_R:"noseSneerRight",tongueOut:"tongueOut"}),e("EyeBrowPart",{browDown_L:"browDownLeft",browDown_R:"browDownRight",browInnerUp:"browInnerUp",browOuterUp_L:"browOuterUpLeft",browOuterUp_R:"browOuterUpRight"}),function(e){e[e.role=0]="role",e[e.top=2]="top",e[e.hairs=1]="hairs",e[e.shoes=4]="shoes",e[e.ears=5]="ears",e[e.glasses=5]="glasses",e[e.down=3]="down"}(u||e("ResType",u={})),function(e){e[e.Init=0]="Init",e[e.ChangeBody=1]="ChangeBody",e[e.ChangeBodyColor=2]="ChangeBodyColor",e[e.ChangeBg=3]="ChangeBg",e[e.RoleAnim=4]="RoleAnim",e[e.RoleScale=5]="RoleScale",e[e.ARKit=6]="ARKit",e[e.Screenshot=7]="Screenshot",e[e.HotUpdate=8]="HotUpdate",e[e.GetGameData=9]="GetGameData",e[e.ChangeRole=10]="ChangeRole",e[e.RotateRole=11]="RotateRole"}(i||e("OperationType",i={})),e("HotUpdateState",{NEW_VERSION_FOUND:1,STARTUPDATE:2,UPDATE_PROGRESSION:3,UPDATE_FINISHED:4,UPDATE_FAILED:5}),e("BoyConfig",{role:{id:"10001",extra:{colorId:""}},body:[{id:"20001",extra:{colorId:""}},{id:"30001",extra:{colorId:""}},{id:"40001",extra:{colorId:""}},{id:"50001",extra:{colorId:""}}],bgId:"80001"}),e("GirlConfig",{role:{id:"10002",extra:{colorId:""}},body:[{id:"20002",extra:{colorId:""}},{id:"30002",extra:{colorId:""}},{id:"40002",extra:{colorId:""}},{id:"50002",extra:{colorId:""}}],bgId:"80001"}),e("ZDBoyConfig",{role:{id:"10001",extra:{colorId:""}},body:[{id:"20001",extra:{colorId:""}},{id:"30001",extra:{colorId:""}},{id:"40004",extra:{colorId:""}},{id:"50001",extra:{colorId:""}}],bgId:"80001"}),e("ZDGirlConfig",{role:{id:"10002",extra:{colorId:""}},body:[{id:"20002",extra:{colorId:""}},{id:"30009",extra:{colorId:""}},{id:"40008",extra:{colorId:""}},{id:"50006",extra:{colorId:""}}],bgId:"80001"}),e("ChangeProgressName",{BodySucc:"1",BodyFail:"2",ColorSucc:"3",ColorFail:"4",SexSucc:"5",SexFail:"6"}),e("DefaultBgId",80001),e("ARKitJSON",{bodyAngleY:"0.000000",bodyAngleX:"0.000000",headPitch:"-.305190",headRoll:"0.120272",headYaw:"0.113890",bodyAngleZ:"0.000000",arFaceAnchors:{eyeBlink_R:0,eyeWide_R:.11568284779787064,mouthLowerDown_L:.09471127390861511,eyeLookUp_R:.03157377988100052,eyeLookDown_R:0,mouthDimple_R:.034721940755844116,browInnerUp:.7,eyeLookIn_L:0,mouthPress_L:.05069126561284065,mouthStretch_R:.13850076496601105,browDown_L:0,mouthFunnel:.10001958161592484,noseSneer_L:.07319952547550201,eyeLookOut_L:.09379855543375015,eyeLookIn_R:.21466870605945587,mouthLowerDown_R:.11480997502803802,browOuterUp_R:.6070342063903809,cheekSquint_R:.13968360424041748,mouthLeft:0,jawOpen:1,eyeBlink_L:7059967174427584e-20,mouthPress_R:.054593488574028015,jawForward:.04523487761616707,cheekPuff:.035196248441934586,jawRight:.019821010529994965,mouthShrugLower:.12843580543994904,eyeSquint_L:.33468562364578247,noseSneer_R:.07916779071092606,mouthFrown_L:.13837255537509918,tongueOut:9875348690707966e-27,mouthStretch_L:.13677266240119934,eyeLookOut_R:0,mouthRollLower:.06201504170894623,mouthUpperUp_R:1.0229104347527027,mouthShrugUpper:.2760515809059143,eyeSquint_R:.3374432921409607,eyeLookDown_L:0,mouthSmile_L:0,eyeWide_L:.1473015993833542,mouthClose:.04615861922502518,jawLeft:0,mouthDimple_L:.03317812830209732,mouthFrown_R:.053437650203704834,mouthPucker:.07633082568645477,mouthRight:.043304312974214554,eyeLookUp_L:.031961459666490555,browDown_R:0,mouthSmile_R:0,mouthUpperUp_L:.017802905291318893,browOuterUp_L:.6073191165924072,mouthRollUpper:.02335493080317974,cheekSquint_L:1}}),t._RF.pop()}}}));

System.register("chunks:///framework/base64.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,r){var n,t,a,o,c;return{setters:[function(e){n=e.createClass,t=e.classCallCheck},function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"7031dC6GaJFnofZ+9yDH2SO","base64",void 0),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=function(){function e(){t(this,e)}return n(e,[{key:"base64encode",value:function(e){for(var r="",n=0;n<e.length;n+=3)if(e.length-n>=3){var t=e.charCodeAt(n),a=e.charCodeAt(n+1),c=e.charCodeAt(n+2);r+=o[t>>2],r+=o[(3&t)<<4|a>>4],r+=o[(15&a)<<2|c>>6],r+=o[63&c]}else if(e.length-n==2){var f=e.charCodeAt(n),i=e.charCodeAt(n+1);r+=o[f>>2],r+=o[(3&f)<<4|i>>4],r+=o[(15&i)<<2],r+=o[64]}else{var u=e.charCodeAt(n);r+=o[u>>2],r+=o[(3&u)<<4],r+=o[64],r+=o[64]}return r}},{key:"base64decode",value:function(e){for(var r="",n=0;n<e.length;n+=4){var t=o.indexOf(e[n]),a=o.indexOf(e[n+1]),c=o.indexOf(e[n+2]),f=o.indexOf(e[n+3]);r+=String.fromCharCode(t<<2|a>>4),64!==c&&(r+=String.fromCharCode((15&a)<<4|c>>2),64!=f&&(r+=String.fromCharCode((3&c)<<6|f)))}return r}}]),e}(),a._RF.pop(),e("default",c)}}}));

System.register("chunks:///framework/event/clientEvent.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,n){var r,t,a,l;return{setters:[function(e){r=e.createClass,t=e.classCallCheck},function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"c9d04694d1DJb1HT4y5WpI4","clientEvent",void 0),e("EVT",l=function(){function e(){t(this,e)}return r(e,null,[{key:"on",value:function(n,r,t){var a={handler:r,target:t},l=e._handlers[n];l||(l=[],e._handlers[n]=l);for(var u=0;u<l.length;u++)if(!l[u])return l[u]=a,u;return l.push(a),l.length}},{key:"off",value:function(n,r,t){var a=e._handlers[n];if(a)for(var l=0;l<a.length;l++){var u=a[l];if(u.handler===r&&(!t||t===u.target)){a.splice(l,1);break}}}},{key:"emit",value:function(n){for(var r=arguments.length,t=new Array(r>1?r-1:0),a=1;a<r;a++)t[a-1]=arguments[a];var l,u=e._handlers[n],c=[];for(l=1;l<arguments.length;l++)c.push(arguments[l]);if(u)for(l=0;l<u.length;l++){var i=u[l];i.handler&&i.handler.apply(i.target,c)}}}]),e}()),l._handlers={},a._RF.pop()}}}));

System.register("chunks:///framework/sdk/SDK.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../Define.js","../event/clientEvent.js"],(function(e,t){var a,n,i,c,s,o,r,l,E;return{setters:[function(e){a=e.createClass,n=e.classCallCheck},function(e){i=e.cclegacy},function(e){c=e.OperationType,s=e.EventName},function(e){o=e.EVT}],execute:function(){i._RF.push({},"c0d3dWvNVdBU6HHITu9BAar","SDK",void 0),r=window.jsb,e("SdkManager",l=function(){function e(){n(this,e)}return a(e,[{key:"onAnimCompete",value:function(e){r.reflection.callStaticMethod("AppController","onAnimCompete:",e)}},{key:"sendToNative",value:function(e,t){r&&r.reflection.callStaticMethod("LMARGameMethodResponder","invoke:params:",e,JSON.stringify(t))}},{key:"task",value:function(e,t){switch(console.log("dwx------------task:".concat(e," parma:").concat(t)),e){case c.Init:o.emit(s.EVT_GAMEINIT,t);break;case c.RoleAnim:o.emit(s.EVT_BODYANIM,JSON.parse(t).roleAnimId);break;case c.ChangeBody:o.emit(s.EVT_BODYCHANGE,t);break;case c.ARKit:o.emit(s.EVT_ARKIT,t);break;case c.ChangeBodyColor:o.emit(s.EVT_BODYCOLORCHANGE,t);break;case c.ChangeBg:o.emit(s.EVT_CHANGEBG,JSON.parse(t).bgId);break;case c.RoleScale:o.emit(s.EVT_CHANGESROLECALE,JSON.parse(t).sc);break;case c.Screenshot:o.emit(s.EVT_SCREENSHOT,t);break;case c.HotUpdate:o.emit(s.EVT_HOTUPDATE,t);break;case c.GetGameData:o.emit(s.EVT_GETGAMEDATA,t);break;case c.ChangeRole:o.emit(s.EVT_CHANGEROLE,t);break;case c.RotateRole:o.emit(s.EVT_ROTATEROLE,JSON.parse(t).deltaX,JSON.parse(t).isReCover)}}}],[{key:"instance",get:function(){return this._instance?this._instance:(this._instance=new e,this._instance)}}]),e}()),e("SDK",E=l.instance),window.CocosBridge=E,i._RF.pop()}}}));

System.register("chunks:///morphContrl.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var o,s,r,h,n,i,l,a,p,c,u,g,m,_,C,f,d;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_temp:void 0}),{setters:[function(t){o=t.applyDecoratedDescriptor,s=t.inherits,r=t.classCallCheck,h=t.possibleConstructorReturn,n=t.getPrototypeOf,i=t.createClass},function(t){l=t.cclegacy,a=t._decorator,p=t.CCFloat,c=t.MeshRenderer,u=t.Component}],execute:function(){l._RF.push({},"15304l1LiBMw6IzdKBMx1Dh","morphContrl",void 0),f=a.ccclass,d=a.property,t("MorphContrl",(g=f("MorphContrl"),m=d({type:[p],range:[0,1,.1],slide:!0}),g((o((C=function(t){function e(){var t,o;r(this,e);for(var s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];return(o=h(this,(t=n(e)).call.apply(t,[this].concat(i))))._weightsControl=[],o._modelComp=null,o._totalTargets=0,o.targetNames=[],o}return s(e,t),i(e,[{key:"setWeights",value:function(t){if(0!==t.length)for(var e=0;e<this._morph.subMeshMorphs.length;++e)this._morph.subMeshMorphs[e]&&this._modelComp.setWeights(t,e)}},{key:"start",value:function(){if(this._modelComp=this.node.getComponent(c),this._modelComp){var t=this._modelComp.mesh;if(t&&(this._morph=t.struct.morph,this._morph))if(0!==this._morph.subMeshMorphs.length){var e=this._morph.subMeshMorphs.find((function(t){return!!t}));if(e){this._morph.subMeshMorphs.every((function(t){return!t||t.targets.length===e.targets.length}))||console.warn("not all submesh count are the same");var o=this._morph.subMeshMorphs[0],s=o?o.targets.length:0;this._totalTargets=s,this.weightsControl=new Array(s).fill(0),this.targetNames=this._morph.targetNames}else console.warn("all submesh don't have morph")}else console.warn("submesh count is 0")}}},{key:"weightsControl",get:function(){return this._weightsControl},set:function(t){t.length==this._totalTargets&&(this._weightsControl=t,this.setWeights(this._weightsControl))}}]),e}(u)).prototype,"weightsControl",[m],Object.getOwnPropertyDescriptor(C.prototype,"weightsControl"),C.prototype),_=C))||_)),l._RF.pop()}}}));

System.register("chunks:///framework/data/GlobalData.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var n,a,s;return{setters:[function(t){n=t.createClass,a=t.classCallCheck},function(t){s=t.cclegacy}],execute:function(){s._RF.push({},"bd471sOP4dJlrh2ConNJDbN","GlobalData",void 0),t("FPS",60),t("GD",function(){function t(){a(this,t),this.version="1.0.1",this.proName="avatar",this.openDebug=!0,this.appArea="",this.GM=null,this.GameSize=null,this.WritablePath=""}return n(t,null,[{key:"getInstance",value:function(){return this._inst||(this._inst=new t)}}]),t}().getInstance()),s._RF.pop()}}}));

System.register("chunks:///framework/logger.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./data/GlobalData.js"],(function(r,t){var e,o,n,i,l,a,s,c,g,u;return{setters:[function(r){e=r.createClass,o=r.classCallCheck,n=r.defineProperty},function(r){i=r,l=r.cclegacy,a=r.js,s=r.sys,c=r.log},function(r){g=r.GD}],execute:function(){l._RF.push({},"18d73/XgXZN+p8ZbLIY6LVo","logger",void 0),u=window.jsb,r("Logger",function(){function r(){o(this,r)}return e(r,null,[{key:"getDateString",value:function(){var r=new Date,t="",e=String(r.getFullYear());return t+=e+"-",t+=(e=String(r.getMonth()))+"-",t+=(e=String(r.getDay()))+" ",t+=(1==(e=String(r.getHours())).length?"0"+e:e)+":",t+=(1==(e=String(r.getMinutes())).length?"0"+e:e)+":",t="["+(t+=(1==(e=String(r.getSeconds())).length?"0"+e:e)+"")+"]"}},{key:"stack",value:function(r){var t=(new Error).stack.split("\n");t.shift();var e=[];t.forEach((function(r){var t=(r=r.substring(7)).split(" ");t.length<2?e.push(t[0]):e.push(n({},t[0],t[1]))}));var o=[];if(r<e.length-1)for(var i in e[r])o.push(i);var l=o[0].split(".");return l[0]+".ts->"+l[1]+": "}},{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];var n=console.log||c;n.call(this,"%s%s:"+a.formatStr.apply(i,arguments),r.stack(2),r.getDateString())}},{key:"info",value:function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];var n=console.log||c;n.call(this,"%c%s%s:"+a.formatStr.apply(i,arguments),"color:#66FFFF;",r.stack(2),r.getDateString())}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];var n=console.log||c;n.call(this,"%c%s%s:"+a.formatStr.apply(i,arguments),"color:#ee7700;",r.stack(2),r.getDateString())}},{key:"err",value:function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];var n=console.log||c;n.call(this,"%c%s%s:"+a.formatStr.apply(i,arguments),"color:red",r.stack(2),r.getDateString())}},{key:"addWindowsErrLister",value:function(){var t,e;s.isNative&&(window.__errorHandler&&(t=window.__errorHandler),window.__errorHandler=function(){console.log("游戏报错,原生系统"),r.writeToFile.apply(r,arguments),t&&t.apply(void 0,arguments)});s.isBrowser&&(window.onerror&&(e=window.onerror),window.onerror=function(){console.log("游戏报错,浏览器"),e&&e.apply(void 0,arguments)})}},{key:"writeToFile",value:function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];console.log("dwx writeToFile :".concat(e)),e=JSON.stringify(e);var n=r.getDateString(),i=n+e+"|";if(u){var l=g.WritablePath;u.fileUtils.isDirectoryExist(l)||u.fileUtils.createDirectory(l),console.log("storagePath:"+l);var a=u.fileUtils.getStringFromFile("".concat(l,"/cocosErrorLog.txt")),s=a.split("|").filter((function(r,t){return t>=100}));if(s.forEach((function(r,t){a+=r})),a.includes(e))return;i+=a,u.fileUtils.writeStringToFile(i,"".concat(l,"/cocosErrorLog.txt"))}}}]),r}()),l._RF.pop()}}}));

System.register("chunks:///hotupdate/HotUpdate.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../Define.js","../framework/sdk/SDK.js","../framework/data/GlobalData.js"],(function(e,t){var a,s,n,i,o,l,r,c,d,h,g,p,u,_,f,E,v,A,m,k,D,S,y,T,C,N,b;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){a=e.applyDecoratedDescriptor,s=e.inherits,n=e.classCallCheck,i=e.possibleConstructorReturn,o=e.getPrototypeOf,l=e.initializerDefineProperty,r=e.assertThisInitialized,c=e.createClass},function(e){d=e.cclegacy,h=e._decorator,g=e.Label,p=e.Asset,u=e.game,_=e.Component},function(e){f=e.HotUpdateState},function(e){E=e.SDK},function(e){v=e.GD}],execute:function(){d._RF.push({},"8ee7ate7OVDEph2ruFCYLQZ","HotUpdate",void 0),C=window.jsb,N=h.ccclass,b=h.property,e("HotUpdate",(A=N("HotUpdate"),m=b(g),k=b(p),A((y=a((S=function(e){function t(){var e,a;n(this,t);for(var s=arguments.length,c=new Array(s),d=0;d<s;d++)c[d]=arguments[d];return a=i(this,(e=o(t)).call.apply(e,[this].concat(c))),l(a,"tip",y,r(a)),l(a,"manifestUrl",T,r(a)),a._updating=!1,a._canRetry=!1,a._storagePath="",a._am=null,a._checkListener=null,a._updateListener=null,a._failCount=0,a.resVersion="",a.versionCompareHandle=null,a}return s(t,e),c(t,[{key:"checkCb",value:function(e){switch(console.log("Code: "+e.getEventCode()),e.getEventCode()){case C.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.tip.string="No local manifest file found, hot update skipped.",console.log("No local manifest file found, hot update skipped.");break;case C.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case C.EventAssetsManager.ERROR_PARSE_MANIFEST:this.tip.string="Fail to download manifest file, hot update skipped.",console.log("Fail to download manifest file, hot update skipped.");break;case C.EventAssetsManager.ALREADY_UP_TO_DATE:this.tip.string="Already up to date with the latest remote version.",console.log("Already up to date with the latest remote version.");break;case C.EventAssetsManager.NEW_VERSION_FOUND:E.sendToNative("onStateChanged",{type:2,state:f.NEW_VERSION_FOUND}),console.log("New version found, please try to update. ("+Math.ceil(this._am.getTotalBytes()/1024)+"kb"),this.tip.string="New version found, please try to update. ("+Math.ceil(this._am.getTotalBytes()/1024)+"kb)",console.log("dwx 通知游戏版本到原生");break;default:return}this._am.setEventCallback(null),this._checkListener=null,this._updating=!1}},{key:"updateCb",value:function(e){var t=!1,a=!1;switch(console.log("dwx updateCb ".concat(e.getEventCode())),e.getEventCode()){case C.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:this.tip.string="No local manifest file found, hot update skipped.",E.sendToNative("onStateChanged",{type:2,state:f.UPDATE_FAILED}),a=!0;break;case C.EventAssetsManager.UPDATE_PROGRESSION:console.log("dwx getDownloadedFiles: ".concat(e.getDownloadedFiles())),console.log("dwx getTotalFiles: ".concat(e.getTotalFiles()));var s=e.getMessage(),n=(e.getDownloadedFiles()/e.getTotalFiles()).toFixed(2);s&&console.log("dwx:"+s),console.log("dwx percent: ".concat(n)),E.sendToNative("onStateChanged",{type:2,state:f.UPDATE_PROGRESSION,progress:n});break;case C.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case C.EventAssetsManager.ERROR_PARSE_MANIFEST:this.tip.string="Fail to download manifest file, hot update skipped.",a=!0,E.sendToNative("onStateChanged",{type:2,state:f.UPDATE_FAILED});break;case C.EventAssetsManager.ALREADY_UP_TO_DATE:this.tip.string="Already up to date with the latest remote version.",a=!0,E.sendToNative("onStateChanged",{type:2,state:f.UPDATE_FAILED}),v.openDebug;break;case C.EventAssetsManager.UPDATE_FINISHED:this.tip.string="Update finished. "+e.getMessage(),E.sendToNative("onStateChanged",{type:2,state:f.UPDATE_FINISHED}),t=!0;break;case C.EventAssetsManager.UPDATE_FAILED:this.tip.string="Update failed. "+e.getMessage(),E.sendToNative("onStateChanged",{type:2,state:f.UPDATE_FAILED}),this._updating=!1,this._canRetry=!0,a=!0;break;case C.EventAssetsManager.ERROR_UPDATING:this.tip.string="Asset update error: "+e.getAssetId()+", "+e.getMessage(),E.sendToNative("onStateChanged",{type:2,state:f.UPDATE_FAILED,value:e.getMessage()}),a=!0;break;case C.EventAssetsManager.ERROR_DECOMPRESS:E.sendToNative("onStateChanged",{type:2,state:f.UPDATE_FAILED,value:e.getMessage()}),a=!0}if(a)return this._am.setEventCallback(null),this._updateListener=null,this._updating=!1,console.log("dwx 更新失败  重启restart"),void setTimeout((function(){u.restart()}),1e3);if(t){console.log("dwx 更新完成 重新启动"),console.log("dwx 设置热更版本号：".concat(this.resVersion)),localStorage.setItem("resVersion",this.resVersion),this._am.setEventCallback(null),this._updateListener=null;var i=C.fileUtils.getSearchPaths(),o=this._am.getLocalManifest().getSearchPaths();console.log(JSON.stringify(o)),Array.prototype.unshift.apply(i,o),localStorage.setItem("HotUpdateSearchPaths",JSON.stringify(i)),C.fileUtils.setSearchPaths(i),setTimeout((function(){u.restart()}),1e3)}}},{key:"retry",value:function(){!this._updating&&this._canRetry&&(this._canRetry=!1,this._am.downloadFailedAssets())}},{key:"checkUpdate",value:function(){if(console.log("dwx checkUpdate"),this._updating)console.log("Checking or updating ...");else{if(this._am.getState()===C.AssetsManager.State.UNINITED){var e=this.manifestUrl.nativeUrl;console.log("dwx checkUpdate".concat(e)),this._am.loadLocalManifest(e)}this._am.getLocalManifest()&&this._am.getLocalManifest().isLoaded()?(this._am.setEventCallback(this.checkCb.bind(this)),this._am.checkUpdate(),this._updating=!0):console.log("Failed to load local manifest ...")}}},{key:"hotUpdate",value:function(){if(this._am&&!this._updating){if(this._am.setEventCallback(this.updateCb.bind(this)),this._am.getState()===C.AssetsManager.State.UNINITED){var e=this.manifestUrl.nativeUrl;console.log("dwx url: ".concat(e)),this._am.loadLocalManifest(e)}this._failCount=0,console.log("dwx 开始更新"),E.sendToNative("onStateChanged",{type:2,state:f.STARTUPDATE}),this._am.update(),this._updating=!0}}},{key:"onLoad",value:function(){var e=this;C&&(this._storagePath=(C.fileUtils?C.fileUtils.getWritablePath():"/")+"blackjack-remote-asset",console.log("Storage path for remote asset : "+this._storagePath),this.versionCompareHandle=function(t,a){return console.log("JS Custom Version Compare: version A is "+t+", version B is "+a),e.resVersion=a,Number(t)-Number(a)},this._am=new C.AssetsManager("",this._storagePath,this.versionCompareHandle),this._am.setVerifyCallback((function(e,t){t.compressed,t.md5,t.path,t.size;return!0})))}},{key:"onDestroy",value:function(){this._updateListener&&(this._am.setEventCallback(null),this._updateListener=null)}}]),t}(_)).prototype,"tip",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=a(S.prototype,"manifestUrl",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=S))||D)),d._RF.pop()}}}));

System.register("chunks:///framework/manager/AssetsManager.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var s,a,r,i,l,n,u,o;return{setters:[function(e){s=e.createClass,a=e.classCallCheck},function(e){r=e.cclegacy,i=e.loader,l=e.log,n=e.TextAsset,u=e.Prefab}],execute:function(){r._RF.push({},"66783hEVBJBRJI9tMApFob2","AssetsManager",void 0),e("AssetsManager",o=function(){function e(){a(this,e),this.triggerFunGame=null,this.callbackGame=null,this.curTotalGame=0,this.curIndexGame=0,this.triggerFun=null,this.callback=null,this.curTotal=0,this.zipcurTotal=0,this.curIndex=0,this.zipcurIndex=0,this.loadingZip=!1,this.isloading=!1,this.curResObj=null,this.resetLoadingTimer=-1,this.resLoadVec=[],this.timerLog={}}return s(e,[{key:"loadResToArray",value:function(t,s){if(s){var a=this;a.timerLog[t]=(new Date).getTime(),i.loadRes(t,s,function(s,r){(new Date).getTime(),a.timerLog[t];s?console.error(s.message||s):(e.loadedIndex++,e.resMapArray[t]=r,this.triggerFun&&this.triggerFun(this.curTotal,e.loadedIndex-this.curIndex),!this.loadingZip&&this.callback&&this.curTotal<=e.loadedIndex-this.curIndex&&(this.callback(),this.isloading=!1,this.curResObj&&this.curResObj.urls&&0!=this.curResObj.urls.length&&l("false当前状态 ".concat(this.curResObj.urls[0].url)),this.resLoadVec.length>0&&this.startLoad()))}.bind(this))}}},{key:"loadRes",value:function(e,t,s){var a={urls:e,option:t,zip:s};a&&a.urls&&0!=a.urls.length&&(this.resLoadVec.push(a),l(" true当前状态 压栈 "+a.urls[0].url),this.isloading||this.startLoad())}},{key:"func_resetLoading",value:function(){this.isloading=!1}},{key:"startLoad",value:function(){var t=this;if(this.curResObj=this.resLoadVec.shift(),this.curResObj&&this.curResObj.urls&&0!=this.curResObj.urls.length){this.isloading=!0,-1!==this.resetLoadingTimer&&clearTimeout(this.resetLoadingTimer),this.resetLoadingTimer=setTimeout((function(){t.isloading=!1}),15e3),l(" true当前状态 出栈 "+this.curResObj.urls[0].url),e.loadedIndex=0,e.ziploadedIndex=0,this.curResObj.option&&(this.triggerFun=this.curResObj.option.trigger,this.callback=this.curResObj.option.cb,this.curTotal=this.curResObj.zip?0:this.curResObj.urls.length,this.curIndex=e.loadedIndex),this.zipcurIndex=e.ziploadedIndex;for(var s=0;s<this.curResObj.urls.length;s++)this.loadResToArray(this.curResObj.urls[s].url,this.curResObj.urls[s].type);0==this.curResObj.urls.length&&(this.triggerFun&&this.triggerFun(this.curTotal,e.loadedIndex-this.curIndex),this.callback&&(this.callback(),this.isloading=!1,this.resLoadVec.length>0&&this.startLoad()))}}},{key:"loadResToArrayGame",value:function(t,s){var a=this;if(s){var r=this;r.timerLog[t]=(new Date).getTime(),i.loadRes(t,s,(function(i,l){var u=(new Date).getTime(),o=r.timerLog[t];console.log(t+"加载耗时："+((u-o)/1e3).toFixed(2)+"秒",5),i?console.error(i.message||i,0):(e.loadedIndexGame++,console.log(" 解析资源数目：========= ".concat(t,"   ")+(e.loadedIndexGame-r.curIndexGame)+" this.curTotal = "+a.curTotalGame,9),e.resMapArray[t]=s==n?l.text:l,a.triggerFunGame&&a.triggerFunGame(a.curTotalGame,e.loadedIndexGame-a.curIndexGame),a.callbackGame&&a.curTotalGame<=e.loadedIndexGame-a.curIndexGame&&a.callbackGame())}))}}},{key:"loadGameRes",value:function(t,s,a){e.loadedIndexGame=0,s&&(this.triggerFunGame=s.trigger,this.callbackGame=s.cb,this.curTotalGame=t.length,this.curIndexGame=e.loadedIndexGame);for(var r=0;r<t.length;r++)this.loadResToArrayGame(t[r].url,t[r].type);0==t.length&&(this.triggerFunGame&&this.triggerFunGame(this.curTotalGame,e.loadedIndexGame-this.curIndexGame),this.callbackGame&&this.callbackGame())}},{key:"loadOneRes",value:function(t,s){this.timerLog[t.url]=(new Date).getTime();var a=e.resMapArray[t.url];a?s(null,a):i.loadRes(t.url,t.type,(function(a,r){if(a)return console.warn(a.message||a),void s(a,null);e.resMapArray[t.url]=r,s&&s(a,r)}))}},{key:"getRes",value:function(t){return e.resMapArray[t]||console.error("has no preload asset "+t),e.resMapArray[t]}},{key:"releaseAsset",value:function(t){var s=i.getDependsRecursively(t);s=s.filter((function(e,t){return!e.includes("1baf0fc9-befa-459c-8bdd-af1a450a0319.json")})),t instanceof u?i.releaseAsset(t):i.release(s),"string"==typeof t&&delete e.resMapArray[t]}},{key:"clearCallBack",value:function(){for(var t in this.callback=null,this.triggerFun=null,this.curTotal=0,this.curIndex=0,this.zipcurTotal=0,this.callbackGame=null,this.triggerFunGame=null,this.curTotalGame=0,this.curIndexGame=0,e.resMapArray)this.releaseAsset(e.resMapArray[t]);e.resMapArray={}}}],[{key:"getInstance",value:function(){return this.instance}}]),e}()),o.instance=new o,o.resMapArray={},o.loadedIndexGame=0,o.loadedIndex=0,o.ziploadedIndex=0,e("AM",o.getInstance()),r._RF.pop()}}}));

System.register("chunks:///utils/EngineUtil.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","../framework/manager/AssetsManager.js","../framework/config/localConfigMgr.js"],(function(e,n){var t,a,i,o,r,l,s,u,c,g,f,v,d,y,m,p,h,C,x,k,S,B,w,R,N,M;return{setters:[function(e){t=e.createClass,a=e.classCallCheck},function(e){i=e.cclegacy,o=e.loader,r=e.error,l=e.SpriteFrame,s=e.UITransform,u=e.UIOpacity,c=e.v3,g=e.view,f=e.Vec2,v=e.v2,d=e.director,y=e.sys,m=e.log,p=e.Prefab,h=e.instantiate,C=e.find,x=e.isValid,k=e.Node,S=e.Sprite,B=e.Label,w=e.AnimationClip},function(e){R=e.AM},function(e){N=e.localConfigMgr}],execute:function(){i._RF.push({},"0e7c04UAi9HhprQTxNN5vyb","EngineUtil",void 0),M=function(){function e(){a(this,e)}return t(e,null,[{key:"loadImage",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"png";o.load({url:n,type:t},(function(n,t){n?r("加载头像纹理错误：",n):e.spriteFrame=t}))}},{key:"locaImage",value:function(e,n){o.loadRes(n,l,(function(n,t){n?r("加载纹理失败",n):e.spriteFrame=t}))}},{key:"convertPosition",value:function(e,n,t){var a=e.getComponent(s).convertToWorldSpaceAR(t);return n.getComponent(s).convertToNodeSpaceAR(a)}},{key:"positionConvert",value:function(e,n){var t=e.parent.getComponent(s).convertToWorldSpaceAR(e.position);return n.getComponent(s).convertToNodeSpaceAR(t)}},{key:"active",value:function(e,n){e&&(e.active=n)}},{key:"activeAllChild",value:function(e,n){if(e)for(var t=0;t<e.children.length;++t)e.children[t].active=n}},{key:"hide",value:function(e,n){e&&(e.getComponent(u).opacity=n?255:0)}},{key:"hideAllChild",value:function(e,n){if(e)for(var t=0;t<e.children.length;++t)e.children[t].getComponent(u).opacity=n?255:0}},{key:"distance",value:function(e,n){var t=e.subtract(n);return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)}},{key:"getCubicBezierVertices",value:function(e,n,t,a,i){for(var o=0,r=[],l=0;l<i;l++){var s=Math.pow(1-o,3)*e.x+3*Math.pow(1-o,2)*o*n.x+3*(1-o)*o*o*t.x+o*o*o*a.x,u=Math.pow(1-o,3)*e.y+3*Math.pow(1-o,2)*o*n.y+3*(1-o)*o*o*t.y+o*o*o*a.y;r.push(c(s,u,1)),o+=1/i}return r.push(c(a.x,a.y,a.z)),r}},{key:"getCollisionEdgePos",value:function(e,n){var t=[],a=g.getViewportRect(),i=a.width,o=a.height,r=new f(.001,.001),l=new f(i-.001,o-.001);t[0]=new f(0,0),t[1]=new f(i,0),t[2]=new f(i,o),t[3]=new f(0,o);var s=e;s.clampf(r,l);var u=e.add(n.multiply(new f(4e6,4e6))),c=new f(0,0);return this.getIntersectPoint(s,u,t[0],t[1],c)||this.getIntersectPoint(s,u,t[2],t[3],c)||this.getIntersectPoint(s,u,t[0],t[3],c)||this.getIntersectPoint(s,u,t[1],t[2],c),c.clampf(r,l),c}},{key:"getIntersectPoint",value:function(e,n,t,a,i){if(e.x==n.x&&e.y==n.y||t.x==a.x&&t.y==a.y)return!1;var o=(a.y-t.y)*(n.x-e.x)-(a.x-t.x)*(n.y-e.y);if(0==o)return!1;var r=((e.y-t.y)*(a.x-t.x)-(e.x-t.x)*(a.y-t.y))/o,l=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/o;return!(r<0||r>1||l<0||l>1)&&(i&&(i.x=e.x+r*(n.x-e.x),i.y=e.y+r*(n.y-e.y)),!0)}},{key:"getAngle",value:function(e,n){return Math.atan2(e.cross(n),e.dot(n))*(180/Math.PI)}},{key:"getAnglePoint2Point",value:function(e,n){var t=e.subtract(n);return v(t.x,t.y).signAngle(v(0,1))/Math.PI*180}},{key:"loadScene",value:function(e,n){d.loadScene(e,(function(){}))}},{key:"isAndroidPlatform",value:function(){return y.os===y.OS.ANDROID}},{key:"isIOSPlatform",value:function(){return y.os===y.OS.IOS}},{key:"isWindowsPlatform",value:function(){return y.os===y.OS.WINDOWS}},{key:"getNodeAndComp",value:function(e,n){for(var t=n.split(":"),a=t[0].split("/"),i=e,o=0;o<a.length;++o)""!==a[o]&&((i=i.getChildByName(a[o]))||m("getNodeAndComp parent is null:parent name = "+e.name));var r={};return t[1]&&(r=i.getComponent(t[1])),{node:i,component:r}}},{key:"showMessageTip",value:function(e){var n=d.getScene().getChildByName("Canvas");R.loadOneRes({url:"prefab/messageTipLabel",type:p},(function(t,a){var i=h(a);n.addChild(i),i.getComponent("MessageTipLabel").init(e),i.getComponent("MessageTipLabel").play()}))}},{key:"showMessageBox",value:function(e,n,t){var a=d.getScene().getChildByName("Canvas"),i=a.getChildByName("messageBox");i?(i.active=!0,i.getComponent("MessageBox").init(),i.getComponent("MessageBox").show(e,n,t)):R.loadOneRes({url:"prefab/messageBox",type:p},(function(o,r){if(i=a.getChildByName("messageBox"))return i.active=!0,void i.getComponent("MessageBox").show(e,n,t);i=h(r),a.addChild(i),i.name="messageBox",i.getComponent("MessageBox").show(e,n,t)}))}},{key:"hideMessageBox",value:function(){var e=d.getScene().getChildByName("Canvas").getChildByName("messageBox");e&&e.removeFromParent()}},{key:"showLoading",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=d.getScene().getChildByName("Canvas"),t=n.getChildByName("messageBox"),a=n.getChildByName("loading");a?(a.active=!0,a.getComponent("Loading").init(e)):R.loadOneRes({url:"prefab/loading",type:p},(function(i,o){if(a=n.getChildByName("loading"))return a.active=!0,void a.getComponent("Loading").init(e);if(a=h(o),t){var r=t.getSiblingIndex();n.insertChild(a,r)}n.addChild(a),a.name="loading",a.getComponent("Loading").init(e)}))}},{key:"hideLoading",value:function(){var e=d.getScene().getChildByName("Canvas").getChildByName("loading");e&&(e.active=!1)}}]),e}(),e("ResourceUtil",function(){function e(){a(this,e)}return t(e,null,[{key:"loadRes",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};o.loadRes(e,n,(function(e,n){if(e)return r(e.message||e),void t(e,n);t&&t(null,n)}))}},{key:"getUIPrefabRes",value:function(e,n){this.loadRes("prefab/"+e,p,n)}},{key:"createUI",value:function(e,n,t){this.getUIPrefabRes(e,(function(e,a){if(!e){var i=h(a);i.setPosition(0,0,0),t||(t=C("Canvas")),t.addChild(i),n&&n(i)}}))}},{key:"getJsonData",value:function(e,n){this.loadRes("pathJson/"+e,null,(function(e,t){e?r(e.message||e):t.json?n(e,t.json):n("failed!!!")}))}},{key:"getTextData",value:function(e,n){this.loadRes("config/"+e,null,(function(e,t){if(e)r(e.message||e);else{var a=t.text;n(e,a)}}))}},{key:"setSpriteFrame",value:function(e,n,t){this.loadRes(e+"/spriteFrame",l,(function(a,i){if(a)return console.error("set sprite frame failed! err:",e,a),void t(a);n&&x(n)&&(n.spriteFrame=i,t(null))}))}},{key:"createSprite",value:function(e,n){var t=(new k).addComponent(S),a=R.getRes(n);return t.spriteFrame=a.getSpriteFrame(e),t.node}},{key:"createSpriteFrame",value:function(e,n){return R.getRes(n).getSpriteFrame(e)}},{key:"createLbWithBMFont",value:function(e,n){var t=(new k).addComponent(B);t.string="";var a=R.getRes("font/"+n);return t.font=a,t.lineHeight=a.fontSize,t.fontSize=a.fontSize,t.string=e,t.node}},{key:"genAnimateByFrames",value:function(e,n,t,a,i){for(var o=R.getRes(e),r=[],l=0,s=a.length;l<s;l++){var u=a[l],c=o.getSpriteFrame(t+"_"+(u<10?"0"+u:u));if(!c)break;r.push(c)}var g=w.createWithSpriteFrames(r,i);return g.name=n,g}},{key:"getFishNormalAnimation",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,a=N.getInstance().queryByID("fish_frame",n.toString()),i="fish_"+n+"_anim",o="fish_"+n,r=a.normalFrames.split(",");return this.genAnimateByFrames(e,i,o,r,t)}}]),e}()),i._RF.pop(),e("default",M)}}}));

System.register("chunks:///framework/manager/CsvManager.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var r,n,i,s,a,u,l,o,c,h,f;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){r=e.createClass,n=e.classCallCheck},function(e){i=e.cclegacy,s=e._decorator}],execute:function(){i._RF.push({},"8117041HG9M+Z9s8GtziwDK","CsvManager",void 0),l=s.ccclass,s.property,h=function(e,t,r,n){return r instanceof Array?"number"===r[t]?Number(n[t]):"boolean"===r[t]?"true"===n[t]||"t"===n[t]||"1"===n[t]:n[t]:isNaN(Number(e))?"false"==e||"true"==e||"t"==e||"f"==e?"true"===n[t]||"t"===n[t]||"1"===n[t]:n[t]:Number(n[t])},f={STANDARD_DECODE_OPTS:{skip:0,limit:!1,header:!1,cast:!1,comment:""},STANDARD_ENCODE_OPTS:{delimiter:(o=[",",";","\t","|","^"])[0],newline:(c=["\r\n","\r","\n"])[0],skip:0,limit:!1,header:!1},quoteMark:'"',doubleQuoteMark:'""',quoteRegex:/"/g,assign:function(){for(var e=Array.prototype.slice.call(arguments),t=e[0],r=e.slice(1),n=0,i=r.length;n<i;n++)for(var s in r[n])t[s]=r[n][s];return t},map:function(e,t){for(var r=[],n=0,i=e.length;n<i;n++)r[n]=t(e[n],n);return r},getType:function(e){return Object.prototype.toString.call(e).slice(8,-1)},getLimit:function(e,t){return!1===e?t:e},buildObjectConstructor:function(e,t,r){return function(n){var i=new Object,s=function(e,t){return i[e]=t};return r?e.forEach((function(e,i){s(e,h(t[i],i,r,n))})):e.forEach((function(e,r){s(e,h(t[r],r,null,n))})),i}},buildArrayConstructor:function(e,t,r){return function(n){var i=new Array(t.length),s=function(e,t){return i[e]=t};return r?e.forEach((function(e,i){s(e,h(t[i],i,r,n))})):e.forEach((function(e,r){s(e,h(t[r],r,null,n))})),i}},frequency:function(e,t,r){void 0===r&&(r=!1);for(var n=0,i=0,s=this.getLimit(r,e.length);i<s&&-1!==(i=e.indexOf(t,i));)i+=1,n++;return n},mostFrequent:function(e,t,r){for(var n,i=t.length-1;i>=0;i--)this.frequency(e,t[i],r)>0&&(n=t[i]);return n||t[0]},unsafeParse:function(e,t,r){var n,i,s=e.split(t.newline);function a(e){var r=e.shift();if(r.indexOf('"')>=0){for(var n=0,i=0,s=0;e.length>0&&(-1!==(n=r.indexOf('"',i))||s%2!=0);)-1!==n?(i=n+1,s++):r=r+t.newline+e.shift();var a,u=[],l=0,o=0,c=0,h=r.length;for(var f in r)if(r.hasOwnProperty(f)){var v=parseInt(f),d=r[f];0===v&&'"'===d&&(l++,o=1),'"'===d&&(l++,r[v-1]===t.delimiter&&o===v&&o++),'"'===d&&l%2==0&&(r[v+1]!==t.delimiter&&v+1!==h||(c=v,a=r.substring(o,c),u.push(a),c=o=c+2)),d===t.delimiter&&l%2==0&&((c=v)>o?(a=r.substring(o,c),u.push(a),c=o=c+1):c===o&&(u.push(""),c=o=c+1))}return(c=h)>=o&&(a=r.substring(o,c),u.push(a)),u}return r.split(t.delimiter)}for(t.skip>0&&s.splice(t.skip),t.header?(!0===t.header?(t.comment=a(s),t.cast=a(s),n=a(s)):"Array"===this.getType(t.header)&&(n=t.header),i=this.buildObjectConstructor(n,s[0].split(t.delimiter),t.cast)):i=this.buildArrayConstructor(n,s[0].split(t.delimiter),t.cast);s.length>0;){var u=a(s);u.length>1&&r(i(u),n[0])}return!0},safeParse:function(e,t,r){t.delimiter;var n=t.newline,i=e.split(n);return t.skip>0&&i.splice(t.skip),!0},encodeCells:function(e,t,r){for(var n=e.slice(0),i=0,s=n.length;i<s;i++)-1!==n[i].indexOf(this.quoteMark)&&(n[i]=n[i].replace(this.quoteRegex,this.doubleQuoteMark)),-1===n[i].indexOf(t)&&-1===n[i].indexOf(r)||(n[i]=this.quoteMark+n[i]+this.quoteMark);return n.join(t)},encodeArrays:function(e,t,r){var n=t.delimiter,i=t.newline;t.header&&"Array"===this.getType(t.header)&&r(this.encodeCells(t.header,n,i));for(var s=0,a=this.getLimit(t.limit,e.length);s<a;s++)r(this.encodeCells(e[s],n,i));return!0},encodeObjects:function(e,t,r){var n,i,s=t.delimiter,a=t.newline;for(var u in n=[],i=[],e[0])n.push(u),i.push(e[0][u]);!0===t.header?r(this.encodeCells(n,s,a)):"Array"===this.getType(t.header)&&r(this.encodeCells(t.header,s,a)),r(this.encodeCells(i,s));for(var l=1,o=this.getLimit(t.limit,e.length);l<o;l++){i=[];for(var c=0,h=n.length;c<h;c++)i.push(e[l][n[c]]);r(this.encodeCells(i,s,a))}return!0},parse:function(e,t,r){var n;if("Function"===this.getType(t)?(r=t,t={}):"Function"!==this.getType(r)?r=(n=[]).push.bind(n):n=[],t=this.assign({},this.STANDARD_DECODE_OPTS,t),this.opts=t,!t.delimiter||!t.newline){var i=Math.min(48,Math.floor(e.length/20),e.length);t.delimiter=t.delimiter||this.mostFrequent(e,o,i),t.newline=t.newline||this.mostFrequent(e,c,i)}return this.unsafeParse(e,t,r)&&(!(n.length>0)||n)},encode:function(e,t,r){var n;return"Function"===this.getType(t)?(r=t,t={}):"Function"!==this.getType(r)&&(r=(n=[]).push.bind(n)),(t=this.assign({},this.STANDARD_ENCODE_OPTS,t)).skip>0&&(e=e.slice(t.skip)),("Array"===this.getType(e[0])?this.encodeArrays:this.encodeObjects)(e,t,r)&&(!(n.length>0)||n.join(t.newline))}},e("CSVManager",(a=l("CSVManager"),a(u=function(){function e(){n(this,e),this._csvTables={},this._csvTableForArr={},this._tableCast={},this._tableComment={}}return r(e,[{key:"addTable",value:function(e,t,r){if(!this._csvTables[e]||r){var n={},i=[];f.parse(t,{header:!0},(function(e,t){n[e[t]]=e,i.push(e)})),this._tableCast[e]=f.opts.cast,this._tableComment[e]=f.opts.comment,this._csvTables[e]=n,this._csvTableForArr[e]=i}}},{key:"getTableArr",value:function(e){return this._csvTableForArr[e]}},{key:"getTable",value:function(e){return this._csvTables[e]}},{key:"queryOne",value:function(e,t,r){var n=this.getTable(e);if(!n)return null;if(!t)return n[r];for(var i in n)if(n.hasOwnProperty(i)&&n[i][t]===r)return n[i]}},{key:"queryByID",value:function(e,t){return this.queryOne(e,null,t)}},{key:"queryAll",value:function(e,t,r){var n=this.getTable(e);if(!n||!t)return null;var i={};for(var s in n)n.hasOwnProperty(s)&&n[s][t]===r&&(i[s]=n[s]);return i}},{key:"queryIn",value:function(e,t,r){var n=this.getTable(e);if(!n||!t)return null;for(var i={},s=Object.keys(n),a=s.length,u=0;u<a;u++){var l=n[s[u]];r.indexOf(l[t])>-1&&(i[s[u]]=l)}return i}},{key:"queryByCondition",value:function(e,t){if(t.constructor!==Object)return null;var r=this.getTable(e);if(!r)return null;for(var n={},i=Object.keys(r),s=i.length,a=Object.keys(t),u=a.length,l=0;l<s;l++){for(var o=r[i[l]],c=!0,h=0;h<u;h++){var f=a[h];c=c&&t[f]===o[f]&&!n[i[l]]}c&&(n[i[l]]=o)}return n}},{key:"queryOneByCondition",value:function(e,t){if(t.constructor!==Object)return null;var r=this.getTable(e);if(!r)return null;var n=Object.keys(t),i=n.length;for(var s in r){for(var a=r[s],u=!0,l=0;l<i;l++){var o=n[l];u=u&&t[o]===a[o]}if(u)return a}return null}},{key:"clear",value:function(){this._csvTables={},this._tableCast={},this._csvTableForArr={},this._tableComment={}}}],[{key:"instance",get:function(){return this._instance?this._instance:(this._instance=new e,this._instance)}}]),e}())||u)),i._RF.pop()}}}));

System.register("chunks:///framework/config/localConfigMgr.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../utils/EngineUtil.js","../manager/CsvManager.js"],(function(n,e){var t,a,r,i,c,u,s;return{setters:[function(n){t=n.createClass,a=n.classCallCheck},function(n){r=n.cclegacy,i=n.loader},function(n){c=n.ResourceUtil},function(n){u=n.CSVManager}],execute:function(){r._RF.push({},"651e5ZcGBNEFqtWDfoon7LT","localConfigMgr",void 0),n("localConfigMgr",s=function(){function n(){a(this,n),this._csvManager=new u,this._callback=new Function,this._progress=new Function,this._currentLoad=0,this._cntLoad=0}return t(n,[{key:"loadConfig",value:function(n,e){this._callback=e,this._progress=n,this._loadCSV()}},{key:"_loadCSV",value:function(){var n=this;i.loadResDir("config",(function(e,t){if(!e){var a=t.filter((function(n){return".md"!==n._native}));n._cntLoad=a.length,a.length?a.forEach((function(e,t,a){c.getTextData(e.name,(function(t,a){n._csvManager.addTable(e.name,a),n._tryToCallbackOnFinished()}))})):n._tryToCallbackOnFinished()}}))}},{key:"queryOne",value:function(n,e,t){return this._csvManager.queryOne(n,e,t)}},{key:"queryByID",value:function(n,e){return this._csvManager.queryByID(n,e)}},{key:"getTable",value:function(n){return this._csvManager.getTable(n)}},{key:"getTableArr",value:function(n){return this._csvManager.getTableArr(n)}},{key:"queryAll",value:function(n,e,t){return this._csvManager.queryAll(n,e,t)}},{key:"queryIn",value:function(n,e,t){return this._csvManager.queryIn(n,e,t)}},{key:"queryByCondition",value:function(n,e){return this._csvManager.queryByCondition(n,e)}},{key:"getValueByKey",value:function(n,e){return this._csvManager.queryOne(n,null,e)}},{key:"_tryToCallbackOnFinished",value:function(){this._callback&&(this._currentLoad++,this._progress(this._currentLoad,this._cntLoad),this._currentLoad>=this._cntLoad&&this._callback())}},{key:"clear",value:function(){this._cntLoad=0,this._currentLoad=0,this._csvManager.clear()}}],[{key:"getInstance",value:function(){return n._instance||(n._instance=new n)}}]),n}()),n("ConfigMgr",s.getInstance()),r._RF.pop()}}}));

System.register("chunks:///framework/ui/selectBodyPartStyle.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","../../Define.js","../event/clientEvent.js","../config/localConfigMgr.js"],(function(e,t){var i,n,o,r,l,a,c,s,u,d,f,v,p,y,g,h,m,C,_,b,k,T,N,B,E,S,P,A;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,n=e.inherits,o=e.classCallCheck,r=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,c=e.assertThisInitialized,s=e.createClass},function(e){u=e.cclegacy,d=e._decorator,f=e.Node,v=e.instantiate,p=e.Label,y=e.Component},function(e){g=e.EventName},function(e){h=e.EVT},function(e){m=e.ConfigMgr}],execute:function(){u._RF.push({},"3f5759qqMNNDqIlSvQGxA3Y","selectBodyPartStyle",void 0),P=d.ccclass,A=d.property,e("SelectBodyPartStyle",(C=P("SelectBodyPartStyle"),_=A(f),b=A(f),k=A(f),C((B=i((N=function(e){function t(){var e,i;o(this,t);for(var n=arguments.length,s=new Array(n),u=0;u<n;u++)s[u]=arguments[u];return i=r(this,(e=l(t)).call.apply(e,[this].concat(s))),a(i,"btn",B,c(i)),a(i,"ly",E,c(i)),a(i,"maskNode",S,c(i)),i.resConfig=null,i}return n(t,e),s(t,[{key:"init",value:function(e){this.resConfig=m.getTable("role");for(var t=0;t<e.length;t++){var i=v(this.btn);i.active=!0,i.name="".concat(e[t].id),i.children[0].getComponent(p).string="".concat(e[t].resName),this.ly.addChild(i)}this.maskNode.on(f.EventType.TOUCH_START,this.closeBtnClick,this)}},{key:"onBtnClick",value:function(e){var t=this.resConfig[e.target.name].resKey;"background"==t?h.emit(g.EVT_CHANGEBG,Number(e.target.name)):"action"==t?h.emit(g.EVT_BODYANIM,e.target.name):h.emit(g.EVT_BODYCHANGE,e.target.name),this.close()}},{key:"closeBtnClick",value:function(){this.close()}},{key:"close",value:function(){this.maskNode.off(f.EventType.TOUCH_START,this.closeBtnClick,this),this.node.removeFromParent()}}]),t}(y)).prototype,"btn",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=i(N.prototype,"ly",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=i(N.prototype,"maskNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=N))||T)),u._RF.pop()}}}));

System.register("chunks:///ImageDownLoad.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,a){var t,n,o;return{setters:[function(e){t=e.createClass,n=e.classCallCheck},function(e){o=e.cclegacy}],execute:function(){o._RF.push({},"c9abb5uwoNMN5aOXsMOR+zd","ImageDownLoad",void 0),e("ImageDownLoad",function(){function e(){n(this,e)}return t(e,null,[{key:"downLoad",value:function(e,a,t){var n=document.createElement("canvas");n.width=a,n.height=t;for(var o=n.getContext("2d"),r=new Uint8Array(e),c=4*a,l=4*t,i=0;i<l;i++){for(var d=i,u=o.createImageData(a,1),s=d*c,g=0;g<c;g++)u.data[g]=r[s+g];o.putImageData(u,0,i)}for(var w=n.toDataURL("image/png",.1).split(","),f=atob(w[1]),m=f.length-1,h=new Uint8Array(m);m--;)h[m]=f.charCodeAt(m);var v=document.getElementById("file_download");v||((v=document.createElement("a")).id="file_download"),v.href=window.URL.createObjectURL(new Blob([h],{type:"image/png"})),v.download="测试",v.click(),window.URL.revokeObjectURL(v.href)}}]),e}()),o._RF.pop()}}}));

System.register("chunks:///GUI.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./Define.js","./framework/sdk/SDK.js","./framework/data/GlobalData.js","./hotupdate/HotUpdate.js","./framework/manager/AssetsManager.js","./framework/ui/selectBodyPartStyle.js","./ImageDownLoad.js"],(function(e,t){var n,o,r,i,a,l,s,c,d,u,h,f,g,p,v,m,C,y,b,S,w,G,k,x,B,_,M,N,D,U,A,I,F,R,z,T,O,j,L,P,E,J,K,X,H,V,Q,Y,q,W,Z,$,ee,te,ne,oe,re,ie;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,o=e.inherits,r=e.classCallCheck,i=e.possibleConstructorReturn,a=e.getPrototypeOf,l=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass},function(e){d=e.cclegacy,u=e._decorator,h=e.Slider,f=e.Node,g=e.Camera,p=e.instantiate,v=e.Label,m=e.EventHandler,C=e.Button,y=e.Vec3,b=e.math,S=e.SpriteFrame,w=e.Sprite,G=e.view,k=e.RenderTexture,x=e.GFXColorAttachment,B=e.GFXLoadOp,_=e.GFXDepthStencilAttachment,M=e.Canvas,N=e.UITransform,D=e.GFXBufferTextureCopy,U=e.director,A=e.Component},function(e){I=e.SDKCallStaticMethodName,F=e.ChangeProgressName,R=e.RoleSex},function(e){z=e.SDK},function(e){T=e.GD},function(e){O=e.HotUpdate},function(e){j=e.AM},function(e){L=e.SelectBodyPartStyle},function(e){P=e.ImageDownLoad}],execute:function(){d._RF.push({},"3b4a82mzh1NDJ3GpkA2mQMY","GUI",void 0),oe=u.ccclass,re=u.property,ie=window.jsb,e("GUI",(E=oe("GUI"),J=re(h),K=re(f),X=re(f),H=re(f),V=re(g),Q=re(g),E((W=n((q=function(e){function t(){var e,n;r(this,t);for(var o=arguments.length,c=new Array(o),d=0;d<o;d++)c[d]=arguments[d];return n=i(this,(e=a(t)).call.apply(e,[this].concat(c))),l(n,"slider",W,s(n)),l(n,"Btn",Z,s(n)),l(n,"Ly",$,s(n)),l(n,"bgNode",ee,s(n)),l(n,"screenShotCamera",te,s(n)),l(n,"mainCamera",ne,s(n)),n.hotUpdateCtrl=null,n.defaultBgId=null,n}return o(t,e),c(t,[{key:"onLoad",value:function(){this.hotUpdateCtrl=this.node.getComponent(O)}},{key:"initDebugUI",value:function(){var e=[];for(var t in T.GM.roleConfig)e.includes(T.GM.roleConfig[t].resKey)||e.push(T.GM.roleConfig[t].resKey);for(var n=0;n<e.length;n++){var o=p(this.Btn);o.children[0].getComponent(v).string=e[n];var r=new m;r.target=this.node,r.handler="onChangeBodyPartClick",r.component="GUI",r.customEventData=e[n],o.getComponent(C).clickEvents.push(r),this.Ly.addChild(p(o))}}},{key:"rotateRole",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(1!=t){var n=T.GM.roleRootNode.eulerAngles.y;n+=.01*("string"==typeof e?JSON.parse(e).deltaX:e),T.GM.roleRootNode.eulerAngles=new y(0,n,0)}else T.GM.roleRootNode.eulerAngles=new y(0,0,0)}},{key:"setRoleScale",value:function(e){var t=1.25+.5*(Number(e)-.5),n=1.9-1.4*(Number(e)-.5);t=b.clamp(t,1,1.5),n=b.clamp(n,1.6,2.6),T.GM.mainCamera.node.setPosition(0,t,n)}},{key:"setBg",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o="bg_80001";n||e.toString()!=T.GM.gameJson.data.bgId||(e=this.defaultBgId),n&&(this.defaultBgId=e);var r=T.GM.roleConfig["".concat(e)];r?o=r.resName:console.error("dwx bg id no exit!!!"),j.loadOneRes({url:"bg/".concat(o,"/spriteFrame"),type:S},(function(n,o){if(n)z.sendToNative(I.onRoleSettingsCallback,{setStatus:F.BodyFail});else{var r=t.bgNode.getComponent(w).spriteFrame.name;r!=o.name&&j.releaseAsset("bg/".concat(r,"/spriteFrame")),z.sendToNative(I.onRoleSettingsCallback,{setStatus:F.BodySucc}),T.GM.gameJson.data.bgId=e.toString(),t.bgNode.getComponent(w).spriteFrame=o}}))}},{key:"screenShot",value:function(e){var t=this;console.log("截屏");var n=G.getVisibleSize().width,o=G.getVisibleSize().height,r=JSON.parse(e),i=r.width,a=r.height,l=r.userdata;T.GM.sex==R.Girl?this.screenShotCamera.node.setPosition(0,1.4,2):this.screenShotCamera.node.setPosition(0,1.5,2),this.screenShotCamera.node.active=!0;var s=new k;s.initialize({width:Math.floor(n),height:Math.floor(o)});var c=new x;c.loadOp=B.LOAD;var d={colorAttachments:[c],depthStencilAttachment:new _};if(s.reset({width:s.width,height:s.height,passInfo:d}),this.screenShotCamera.targetTexture=s,this.scheduleOnce((function(){t.node.getComponent(M).targetTexture=s})),T.openDebug){var u=(new f).addComponent(w),h=new S;h.texture=s,u.spriteFrame=h,u.node.getComponent(N).setContentSize(i,a),u.node.parent=this.node}this.scheduleOnce((function(){var e=(n-i)/2,o=a/3*2,r={width:i,format:"rgba",height:a,size:i*a*4,buffer:t.getBuffer(s,e,o,i,a),userdata:l};ie&&z.sendToNative("onScreenShotCallback",r),t.screenShotCamera.node.active=!1,t.screenShotCamera.targetTexture=null,t.node.getComponent(M).targetTexture=null}),.3)}},{key:"getBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;o=o||e.width,r=r||e.height;var i=e.getGFXTexture();if(!i)return null;var a=new ArrayBuffer(o*r*4),l=new D;function s(e){return Array.prototype.map.call(new Uint8Array(e),(function(e){return("00"+e.toString(16)).slice(-2)})).join("")}return l.texOffset.x=t,l.texOffset.y=n,l.texExtent.width=o,l.texExtent.height=r,U.root.device.copyFramebufferToBuffer(e.window.framebuffer,a,[l]),T.openDebug&&P.downLoad(a,o,r),s(a)}},{key:"onChangeBodyPartClick",value:function(e,t){var n=[];for(var o in T.GM.roleConfig){var r=T.GM.roleConfig[o];r.resKey!=t||T.GM.sex!=r.sex&&r.sex!=R.Both||n.push(T.GM.roleConfig[o])}if(0!=n.length){var i=p(j.getRes("prefab/Layout"));this.node.addChild(i),i.getComponent(L).init(n)}}},{key:"onSliderEvent",value:function(){this.setRoleScale(this.slider.progress)}},{key:"checkHot",value:function(){this.hotUpdateCtrl.checkUpdate()}},{key:"hotUpdate",value:function(){this.hotUpdateCtrl.hotUpdate()}},{key:"screenShotBtn",value:function(){this.screenShot(JSON.stringify({width:500,height:500,userdata:1}))}}]),t}(A)).prototype,"slider",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=n(q.prototype,"Btn",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=n(q.prototype,"Ly",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=n(q.prototype,"bgNode",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=n(q.prototype,"screenShotCamera",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=n(q.prototype,"mainCamera",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=q))||Y)),d._RF.pop()}}}));

System.register("chunks:///framework/DynamicBone/Particle.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(i,t){var e,r,n,o,s,a,l,c,u,p,h,f,d;return i({_class:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(i){e=i.applyDecoratedDescriptor,r=i.classCallCheck,n=i.initializerDefineProperty},function(i){o=i.cclegacy,s=i._decorator,a=i.v3,l=i.quat}],execute:function(){o._RF.push({},"249e9YH+u1DdrteNf3hBLUX","Particle",void 0),d=s.property,i("Particle",(u=e((c=function i(){r(this,i),this.index=-1,this.parent=-1,this.node=null,this.position=a(),this.prevPosition=a(),this.initLocalPosition=a(),this.initLocalRotation=l(),this.endOffset=a(),this.lengthToRoot=0,n(this,"damping",u,this),n(this,"elasticity",p,this),n(this,"stiffness",h,this),n(this,"inert",f,this),this.radius=0}).prototype,"damping",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),p=e(c.prototype,"elasticity",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),h=e(c.prototype,"stiffness",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),f=e(c.prototype,"inert",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),c)),o._RF.pop()}}}));

System.register("chunks:///framework/DynamicBone/DynamicBoneSettings.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var i,o,r,n,c,a,l,s,u,p,d,y,b,g,v,f,_,h,m,D,w,I,B,S;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){i=e.applyDecoratedDescriptor,o=e.inherits,r=e.classCallCheck,n=e.possibleConstructorReturn,c=e.getPrototypeOf,a=e.initializerDefineProperty,l=e.assertThisInitialized,s=e.createClass},function(e){u=e.cclegacy,p=e._decorator,d=e.Component}],execute:function(){u._RF.push({},"8104cbvGrpKvpB+yCZLNSmS","DynamicBoneSettings",void 0),w=p.ccclass,I=p.property,B=p.disallowMultiple,S=p.executeInEditMode,e("DynamicBoneSettings",(y=w("DynamicBoneSettings"),b=I({tooltip:"是否在编辑器中进行调试"}),g=I({tooltip:"是否在编辑器中显示调试绘图"}),v=I({tooltip:"是否在最终结果中显示调试绘图"}),y(f=S(f=B((h=i((_=function(e){function t(){var e,i;r(this,t);for(var o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];return i=n(this,(e=c(t)).call.apply(e,[this].concat(s))),a(i,"debugInEditor",h,l(i)),a(i,"showDebugInEditor",m,l(i)),a(i,"showDebugInPlayer",D,l(i)),i}return o(t,e),s(t,[{key:"onLoad",value:function(){t.I=this}}]),t}(d)).prototype,"debugInEditor",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=i(_.prototype,"showDebugInEditor",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),D=i(_.prototype,"showDebugInPlayer",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=_))||f)||f)||f)),u._RF.pop()}}}));

System.register("chunks:///framework/DynamicBone/Pool.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(o,t){var e,i,l,n,u,p,s,h,r,c,a,_,f;return{setters:[function(o){e=o.createClass,i=o.classCallCheck},function(o){l=o.cclegacy,n=o.Vec2,u=o.Vec3,p=o.Vec4,s=o.Quat,h=o.Mat4}],execute:function(){l._RF.push({},"837b7S05tBMPJ7zl101pNup","Pool",void 0),o("Vec2Pool",r=function(){function o(){i(this,o)}return e(o,null,[{key:"get",value:function(o,t){if(o=o||0,t=t||0,this._poolSize>0){this._poolSize--;var e=this._pool.pop();return e.set(o,t),e}return new n(o,t)}},{key:"put",value:function(o){this._pool.push(o),this._poolSize++}},{key:"puts",value:function(){for(var o=0;o<arguments.length;o++)this.put(o<0||arguments.length<=o?void 0:arguments[o])}},{key:"clear",value:function(){this._pool.length=0,this._poolSize=0}}]),o}()),r._pool=[],r._poolSize=0,o("Vec3Pool",c=function(){function o(){i(this,o)}return e(o,null,[{key:"get",value:function(o,t,e){if(o=o||0,t=t||0,e=e||0,this._poolSize>0){this._poolSize--;var i=this._pool.pop();return i.set(o,t,e),i}return new u(o,t,e)}},{key:"put",value:function(o){this._pool.push(o),this._poolSize++}},{key:"puts",value:function(){for(var o=0;o<arguments.length;o++)this.put(o<0||arguments.length<=o?void 0:arguments[o])}},{key:"clear",value:function(){this._pool.length=0,this._poolSize=0}}]),o}()),c._pool=[],c._poolSize=0,o("Vec4Pool",a=function(){function o(){i(this,o)}return e(o,null,[{key:"get",value:function(o,t,e,i){if(o=o||0,t=t||0,e=e||0,i=i||0,this._poolSize>0){this._poolSize--;var l=this._pool.pop();return l.set(o,t,e,i),l}return new p(o,t,e,i)}},{key:"put",value:function(o){this._pool.push(o),this._poolSize++}},{key:"puts",value:function(){for(var o=0;o<arguments.length;o++)this.put(o<0||arguments.length<=o?void 0:arguments[o])}},{key:"clear",value:function(){this._pool.length=0,this._poolSize=0}}]),o}()),a._pool=[],a._poolSize=0,o("QuatPool",_=function(){function o(){i(this,o)}return e(o,null,[{key:"get",value:function(o,t,e,i){if(o=o||0,t=t||0,e=e||0,i=i||0,this._poolSize>0){this._poolSize--;var l=this._pool.pop();return l.set(o,t,e,i),l}return new s(o,t,e,i)}},{key:"put",value:function(o){this._pool.push(o),this._poolSize++}},{key:"puts",value:function(){for(var o=0;o<arguments.length;o++)this.put(o<0||arguments.length<=o?void 0:arguments[o])}},{key:"clear",value:function(){this._pool.length=0,this._poolSize=0}}]),o}()),_._pool=[],_._poolSize=0,o("Mat4Pool",f=function(){function o(){i(this,o)}return e(o,null,[{key:"get",value:function(o){if(this._poolSize>0){this._poolSize--;var t=this._pool.pop();return t.set(o),t}return new h(o)}},{key:"put",value:function(o){this._pool.push(o),this._poolSize++}},{key:"puts",value:function(){for(var o=0;o<arguments.length;o++)this.put(o<0||arguments.length<=o?void 0:arguments[o])}},{key:"clear",value:function(){this._pool.length=0,this._poolSize=0}}]),o}()),f._pool=[],f._poolSize=0,l._RF.pop()}}}));

System.register("chunks:///framework/DynamicBone/Utils.js",["cc","./DynamicBoneSettings.js","./Pool.js"],(function(t,n){var r,o,e,a,u,i,c,l,s,m,f;function p(t,n,r){var o=l.get();return a.fromTranslation(t,r),a.fromQuat(o,n),t.multiply(o),a.fromTranslation(o,new e(-r.x,-r.y,-r.z)),t.multiply(o),l.put(o),t}return t({mirrorVector:function(t,n,r){t.set(n);var o=c.get(r);return t.subtract(o.multiplyScalar(2*e.dot(n,r))),c.put(o),t},needShowDebug:function(){return!i.I||!i.I.enabled||!!(m&&i.I.showDebugInEditor||!m&&i.I.showDebugInPlayer)},projectVector:function(t,n,r){var o=c.get(r),a=Math.max(0,e.dot(n,r));return o.multiplyScalar(a),t.set(o),c.put(o),t},rotate:function(t,n,r,o){var u=l.get();return a.fromTranslation(t,o),a.fromRotation(u,r,n),t.multiply(u),a.fromTranslation(u,new e(-o.x,-o.y,-o.z)),t.multiply(u),l.put(u),t},rotateQ:p,rotateR:function(t,n,r){var o=u.fromEuler(s.get(),n.x,n.y,n.z),e=p(t,o,r);return s.put(o),e},transformDirection:function(t,n,r){return e.transformMat4(t,n,r),f.set(0,0,0),e.transformMat4(f,f,r),t.subtract(f),t}}),{setters:[function(t){r=t.cclegacy,o=t.v3,e=t.Vec3,a=t.Mat4,u=t.Quat},function(t){i=t.DynamicBoneSettings},function(t){c=t.Vec3Pool,l=t.Mat4Pool,s=t.QuatPool}],execute:function(){r._RF.push({},"89eceqLwSpFv7lmhOveIj8/","Utils",void 0),m=window.CC_EDITOR,f=o(),r._RF.pop()}}}));

System.register("chunks:///framework/DynamicBone/Plane.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./Pool.js"],(function(t,n){var e,i,s,a,o,r;return{setters:[function(t){e=t.createClass,i=t.classCallCheck},function(t){s=t.cclegacy,a=t.Vec3,o=t.math},function(t){r=t.Vec3Pool}],execute:function(){s._RF.push({},"1b2550jsyZKgbwOPkNquNd/","Plane",void 0),t("Plane",function(){function t(n,e,s){i(this,t),this.size=16,this._normal=new a(0,1,0),this._distance=0,this.set(n,e,s)}return e(t,[{key:"normal",get:function(){return this._normal},set:function(t){this._normal=t}},{key:"distance",get:function(){return this._distance},set:function(t){this._distance=t}}]),e(t,[{key:"set",value:function(t,n,e){e?this.set3Points(t,n,e):"number"==typeof n?this.setNormalAndDistance(t,n):this.setNormalAndPosition(t,n)}},{key:"setNormalAndPosition",value:function(t,n){this.normal.set(t||a.UP),this.distance=-this.normal.dot(n||a.ZERO)}},{key:"setNormalAndDistance",value:function(t,n){this.normal.set(t||a.UP),this.distance=n}},{key:"set3Points",value:function(t,n,e){var i=r.get(n),s=r.get(e),o=r.get();this.normal.set(a.cross(o,i.subtract(t),s.subtract(e)).normalize()),this.distance=-this.normal.dot(t),r.put(i),r.put(s),r.put(o)}},{key:"flip",value:function(){this.normal.multiplyScalar(-1),this.distance=-this.distance}},{key:"flipped",value:function(n){var e=r.get(this.normal);return e.multiplyScalar(-1),(n=n||new t).set(e,-this.distance),r.put(e),n}},{key:"translate",value:function(t){this.distance+=this.normal.dot(t)}},{key:"closetsPointOnPlane",value:function(t,n){var e=a.dot(this.normal,t)+this.distance;n.set(t);var i=r.get(this.normal).multiplyScalar(e);return n.subtract(i),r.put(i),n}},{key:"getDistanceToPoint",value:function(t){return this.normal.dot(t)+this.distance}},{key:"getSide",value:function(t){return a.dot(this.normal,t)+this.distance>0}},{key:"sameSide",value:function(t,n){var e=this.getDistanceToPoint(t),i=this.getDistanceToPoint(n);return e>0&&i>0||e<=0&&i<=0}},{key:"rayCast",value:function(t){var n=a.dot(t.d,this.normal);if(o.equals(n,0))return{dist:0,ret:!1};var e=-(a.dot(this.normal,t.o)+this.distance)/n;return{dist:e,ret:e>0}}}],[{key:"translate",value:function(n,e){return new t(n.normal,n.distance+n.normal.dot(e))}}]),t}()),s._RF.pop()}}}));

System.register("chunks:///framework/DynamicBone/Enums.js",["cc"],(function(e,n){var s,c;return{setters:[function(e){s=e.cclegacy,c=e.Enum}],execute:function(){s._RF.push({},"92df7sPdINDlL9mKv7bRRe1","Enums",void 0),e("EFreezeAxis",c({None:0,X:1,Y:2,Z:3})),e("EDirection",c({X:0,Y:1,Z:2})),e("EBound",c({Outside:0,Inside:1})),s._RF.pop()}}}));

System.register("chunks:///framework/DynamicBone/DynamicBoneColliderBase.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./Utils.js","./Enums.js"],(function(e,i){var o,t,n,r,c,u,a,l,s,d,p,f,y,v,b,_,h,g,m,D,w,B,E,I,k,C,z,F,R,L,P,j,T,G;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inherits,n=e.classCallCheck,r=e.possibleConstructorReturn,c=e.getPrototypeOf,u=e.initializerDefineProperty,a=e.assertThisInitialized,l=e.createClass},function(e){s=e.cclegacy,d=e._decorator,p=e.v3,f=e.Component},function(e){y=e.needShowDebug},function(e){v=e.EDirection,b=e.EBound}],execute:function(){s._RF.push({},"46256i8gUhBsLk/nD64gMbW","DynamicBoneColliderBase",void 0),P=d.ccclass,j=d.property,T=d.executeInEditMode,d.disallowMultiple,G=window.CC_EDITOR,e("DynamicBoneColliderBase",(_=P("DynamicBoneColliderBase"),h=j({type:v,tooltip:"方向"}),g=j({tooltip:"旋转角度"}),m=j({tooltip:"中心点"}),D=j({type:b,tooltip:"边界类型"}),w=j({tooltip:"忽略目标碰撞半径，目标将会在中心点进行碰撞检测"}),B=j({tooltip:"是否显示调试图形"}),_(E=T((k=o((I=function(e){function i(){var e,o;n(this,i);for(var t=arguments.length,l=new Array(t),s=0;s<t;s++)l[s]=arguments[s];return o=r(this,(e=c(i)).call.apply(e,[this].concat(l))),u(o,"direction",k,a(o)),u(o,"rotate",C,a(o)),u(o,"center",z,a(o)),u(o,"bound",F,a(o)),u(o,"ignoreTargetRadius",R,a(o)),u(o,"showDebugGizmos",L,a(o)),o._focusInEditor=!1,o}return t(i,e),l(i,[{key:"onLoad",value:function(){if(G)for(var e=this.node;!this._dynamicBone&&e;)this._dynamicBone=e.getComponent("DynamicBone"),e=e.parent}},{key:"onFocusInEditor",value:function(){this._focusInEditor=!0}},{key:"onLostFocusInEditor",value:function(){this._focusInEditor=!1}},{key:"onParentFocusInEditor",value:function(){this.onFocusInEditor()}},{key:"onParentLostFocusInEditor",value:function(){this.onLostFocusInEditor()}},{key:"collide",value:function(e,i,o){return null}},{key:"lateUpdate",value:function(e){if(this.showDebugGizmos&&y()){if(!this.enabled||G&&!this._focusInEditor)return;this.debugDraw()}}},{key:"debugDraw",value:function(){}}]),i}(f)).prototype,"direction",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return v.X}}),C=o(I.prototype,"rotate",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p()}}),z=o(I.prototype,"center",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p()}}),F=o(I.prototype,"bound",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return b.Outside}}),R=o(I.prototype,"ignoreTargetRadius",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),L=o(I.prototype,"showDebugGizmos",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E=I))||E)||E)),s._RF.pop()}}}));

System.register("chunks:///framework/DynamicBone/DynamicBone.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./Particle.js","./DynamicBoneSettings.js","./Pool.js","./Utils.js","./Plane.js","./Enums.js","./DynamicBoneColliderBase.js"],(function(t,i){var e,o,r,n,s,a,l,d,c,u,p,h,f,v,b,g,_,m,y,P,w,D,z,k,M,j,E,x,C,R,O,T,I,S,N,L,B,F,A,W,G,U,q,H,V,Q,X,J,Y,Z,K,$,tt,it,et,ot,rt,nt,st,at,lt,dt,ct,ut,pt,ht,ft,vt,bt,gt,_t,mt,yt,Pt,wt,Dt,zt,kt,Mt,jt,Et,xt,Ct,Rt,Ot,Tt,It,St,Nt,Lt;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_dec13:void 0,_dec14:void 0,_dec15:void 0,_dec16:void 0,_dec17:void 0,_dec18:void 0,_dec19:void 0,_dec20:void 0,_dec21:void 0,_dec22:void 0,_dec23:void 0,_dec24:void 0,_dec25:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_descriptor12:void 0,_descriptor13:void 0,_descriptor14:void 0,_descriptor15:void 0,_descriptor16:void 0,_descriptor17:void 0,_descriptor18:void 0,_descriptor19:void 0,_descriptor20:void 0,_descriptor21:void 0,_descriptor22:void 0,_descriptor23:void 0,_descriptor24:void 0,_temp:void 0}),{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inherits,r=t.classCallCheck,n=t.possibleConstructorReturn,s=t.getPrototypeOf,a=t.initializerDefineProperty,l=t.assertThisInitialized,d=t.createClass,c=t.createForOfIteratorHelper},function(t){u=t.cclegacy,p=t._decorator,h=t.Node,f=t.CCInteger,v=t.CurveRange,b=t.CCFloat,g=t.v3,_=t.director,m=t.Camera,y=t.Color,P=t.Vec3,w=t.math,D=t.Quat,z=t.Component},function(t){k=t.Particle},function(t){M=t.DynamicBoneSettings},function(t){j=t.Vec3Pool,E=t.Mat4Pool,x=t.QuatPool},function(t){C=t.needShowDebug,R=t.transformDirection,O=t.projectVector},function(t){T=t.Plane},function(t){I=t.EFreezeAxis},function(t){S=t.DynamicBoneColliderBase}],execute:function(){u._RF.push({},"01c26xnwdROBJWLRXj19yA2","DynamicBone",void 0),Tt=p.ccclass,It=p.property,St=p.executeInEditMode,Nt=window.CC_EDITOR,t("DynamicBone",(N=Tt("DynamicBone"),L=It({type:h,tooltip:"动态骨骼根节点"}),B=It({type:f,tooltip:"刷新频率"}),F=It({range:[0,1],tooltip:"阻尼"}),A=It({type:v,tooltip:"阻尼变化曲线",range:[0,1]}),W=It({range:[0,1],tooltip:"弹性"}),G=It({type:v,tooltip:"弹性变化曲线",range:[0,1]}),U=It({range:[0,1],tooltip:"硬度"}),q=It({type:v,tooltip:"硬度变化曲线",range:[0,1]}),H=It({range:[0,1],tooltip:"惰性"}),V=It({type:v,tooltip:"惰性变化曲线",range:[0,1]}),Q=It({type:b,tooltip:"碰撞半径"}),X=It({type:v,tooltip:"碰撞半径变化曲线",range:[0,1]}),J=It({type:h,tooltip:"尾部延长节点"}),Y=It({tooltip:"末尾节点偏移量"}),Z=It({tooltip:"世界坐标下的重力"}),K=It({tooltip:"常驻外力"}),$=It({type:I,tooltip:"冻结平面轴"}),tt=It({type:[S],tooltip:"碰撞器"}),it=It({type:[h],tooltip:"排除当前节点及其子节点"}),et=It({tooltip:"是否开启物理模拟距离测试，默认相对于相机"}),ot=It({type:h,tooltip:"用于相对距离测试计算"}),rt=It({tooltip:"距离测试阈值"}),nt=It({tooltip:"是否允许在编辑器下进行物理模拟"}),st=It({tooltip:"是否显示调试图形"}),N(at=St((dt=e((lt=function(t){function i(){var t,e;r(this,i);for(var o=arguments.length,d=new Array(o),c=0;c<o;c++)d[c]=arguments[c];return e=n(this,(t=s(i)).call.apply(t,[this].concat(d))),a(e,"root",dt,l(e)),a(e,"updateRate",ct,l(e)),a(e,"damping",ut,l(e)),a(e,"dampingDistrib",pt,l(e)),a(e,"elasticity",ht,l(e)),a(e,"elasticityDistrib",ft,l(e)),a(e,"stiffness",vt,l(e)),a(e,"stiffnessDistrib",bt,l(e)),a(e,"inert",gt,l(e)),a(e,"inertDistrib",_t,l(e)),a(e,"radius",mt,l(e)),a(e,"radiusDistrib",yt,l(e)),a(e,"endNode",Pt,l(e)),a(e,"endOffset",wt,l(e)),a(e,"gravity",Dt,l(e)),a(e,"force",zt,l(e)),a(e,"freezeAxis",kt,l(e)),a(e,"colliders",Mt,l(e)),a(e,"excludeNodes",jt,l(e)),a(e,"distantDisable",Et,l(e)),a(e,"refenceObject",xt,l(e)),a(e,"distanceToObject",Ct,l(e)),a(e,"enableEditorDebug",Rt,l(e)),a(e,"showDebugGizmos",Ot,l(e)),e._particles=[],e._totalLength=0,e._localGravity=g(),e._objectMove=g(),e._objectPrePosition=g(),e._objectScale=1,e._time=0,e._weight=1,e._distantDisabled=!1,e._updateCount=0,e.isOpen=!1,e._enableEditorDebug=!1,e}return o(i,t),d(i,[{key:"canRun",value:function(){return!Nt||(!this._distantDisabled||!this.distantDisable)&&(this._enableEditorDebug!=this.enableEditorDebug&&(this.enableEditorDebug?this.setup():this.initTransform(),this._enableEditorDebug=this.enableEditorDebug),M.I?M.I.debugInEditor:this._enableEditorDebug)}},{key:"onLoad",value:function(){this.initial()}},{key:"initial",value:function(){this._enableEditorDebug=this.enableEditorDebug,this.checkColliders(),this.setup()}},{key:"checkColliders",value:function(){var t,i=[],e=c(this.colliders);try{for(e.s();!(t=e.n()).done;){var o=t.value;if(o){var r,n=o.node.getComponents(S),s=c(n);try{for(s.s();!(r=s.n()).done;){var a=r.value;i.push(a)}}catch(t){s.e(t)}finally{s.f()}}}}catch(t){e.e(t)}finally{e.f()}this.colliders=i}},{key:"onEnable",value:function(){this.canRun()&&this.resetParticlesPosition()}},{key:"onDisable",value:function(){this.canRun()&&this.initTransform()}},{key:"update",value:function(t){if(this.isOpen)if(this.canRun()){if(!this._camera){var i=_.root.ui.getFirstRenderCamera(this.node);this._camera=i.node.getComponent(m)}this.preUpdate()}else this.resetParticlesPosition()}},{key:"onRestore",value:function(){this.canRun()&&(this.initTransform(),this.setup())}},{key:"onFocusInEditor",value:function(){this._focusInEditor==this.__focusInEditor&&this._focusInEditor||(this._focusInEditor=!0,this.__focusInEditor=!0,this.canRun()&&(this.initTransform(),this.setup()))}},{key:"onLostFocusInEditor",value:function(){this._focusInEditor=!1,this.initTransform(),this.setup()}},{key:"onParentFocusInEditor",value:function(){this.onFocusInEditor()}},{key:"onParentLostFocusInEditor",value:function(){this.onLostFocusInEditor()}},{key:"debugDraw",value:function(){if(this.enabled&&this.root&&(!Nt||this._focusInEditor)){var t=_.root.pipeline.geometryRenderer;if(t)for(var i=0;i<this._particles.length;i++){var e=this._particles[i];if(e.parent>=0){var o=this._particles[e.parent];t.addLine(e.position,o.position,y.WHITE)}e.radius>0&&t.addSphere(e.position,e.radius*this._objectScale,y.WHITE,4,4,!0,!0,!0)}}}},{key:"lateUpdate",value:function(t){this.isOpen&&(this.showDebugGizmos&&C()&&this.debugDraw(),this.distantDisable&&this.checkDistance(),this.canRun()&&this._weight>0&&this.updateDynamicBones(t))}},{key:"preUpdate",value:function(){this._weight>0&&this.initTransform()}},{key:"checkDistance",value:function(){var t=this.refenceObject;if(!t&&this._camera&&(t=this._camera.node),t){var i=j.get();P.subtract(i,t.worldPosition,this.node.worldPosition);var e=P.lengthSqr(i);j.put(i);var o=e>this.distanceToObject*this.distanceToObject;this._distantDisabled!=o&&(this._distantDisabled=o,o||this.resetParticlesPosition())}}},{key:"updateDynamicBones",value:function(t){if(this.isOpen&&this.root){this._objectScale=Math.abs(this.node.scale.x),this._objectMove.set(this.node.worldPosition).subtract(this._objectPrePosition),this._objectPrePosition.set(this.node.worldPosition);var i=1;if(this.updateRate>0){var e=1/this.updateRate;for(this._time+=t,i=0;this._time>e;)if(this._time-=e,++i>=3){this._time=0;break}}if(i>0)for(var o=0;o<i;o++)this.updateParticles1(),this.updateParticles2(),this._objectMove.set(0,0,0),this._updateCount++;else this.skipUpdateParticles(),this._updateCount=0;this.applyParticlesToTransforms()}}},{key:"setup",value:function(){if(this._particles.length=0,this.root){this.root.updateWorldTransform();var t=E.get(this.root.worldMatrix).invert();P.transformMat4(this._localGravity,this.gravity,t),E.put(t),this._objectScale=Math.abs(this.node.scale.x),this._objectPrePosition.set(this.node.worldPosition),this._objectMove.set(0,0,0),this._totalLength=0,this.appendParticle(this.root,-1,0),this.updateParameters()}}},{key:"appendParticle",value:function(t,i,e){var o=j.get(),r=this._particles.length,n=new k;if(n.index=r,n.node=t,n.parent=i,this._particles.push(n),t)t.getWorldPosition(n.position),n.prevPosition.set(n.position),t.getPosition(n.initLocalPosition),t.getRotation(n.initLocalRotation);else{var s=this._particles[i].node;this.endNode?this.endNode.getWorldPosition(o):(R(o,this.endOffset,this.node.worldMatrix),o.add(s.worldPosition));var a=E.get(s.worldMatrix).invert();P.transformMat4(n.endOffset,o,a),E.put(a),n.position.set(o),n.prevPosition.set(o),j.put(o)}if(i>=0&&(e+=P.distance(this._particles[i].node.position,n.position),n.lengthToRoot=e,this._totalLength=Math.max(this._totalLength,e)),t){for(var l=0;l<t.children.length;l++){var d=t.children[l];this.endNode==d||this.excludeNodes&&this.excludeNodes.indexOf(d)>=0?this.endNode&&this.appendParticle(null,r,e):this.appendParticle(d,r,e)}if(0==t.children.length&&!this.endOffset.equals3f(0,0,0)||1==t.children.length&&t.children[0]==this.endNode)return void this.appendParticle(null,r,e)}}},{key:"updateParameters",value:function(){if(this.root){var t=E.get(this.root.worldMatrix).invert();R(this._localGravity,this.gravity,t),E.put(t);for(var i=0;i<this._particles.length;i++){var e=this._particles[i];if(e.damping=this.damping,e.elasticity=this.elasticity,e.stiffness=this.stiffness,e.inert=this.inert,e.radius=this.radius,this._totalLength>0){var o=e.lengthToRoot/this._totalLength;this.dampingDistrib.mode==v.Mode.Curve&&this.dampingDistrib.curve._times.length>0&&(e.damping*=this.dampingDistrib.curve.evaluate(o)),this.elasticityDistrib.mode==v.Mode.Curve&&this.elasticityDistrib.curve._times.length>0&&(e.elasticity*=this.elasticityDistrib.curve.evaluate(o)),this.stiffnessDistrib.mode==v.Mode.Curve&&this.stiffnessDistrib.curve._times.length>0&&(e.stiffness*=this.stiffnessDistrib.curve.evaluate(o)),this.inertDistrib.mode==v.Mode.Curve&&this.inertDistrib.curve._times.length>0&&(e.inert*=this.inertDistrib.curve.evaluate(o)),this.radiusDistrib.mode==v.Mode.Curve&&this.radiusDistrib.curve._times.length>0&&(e.radius*=this.radiusDistrib.curve.evaluate(o))}e.damping=w.clamp01(e.damping),e.elasticity=w.clamp01(e.elasticity),e.stiffness=w.clamp01(e.stiffness),e.inert=w.clamp01(e.inert),e.radius=Math.max(e.radius,0)}}}},{key:"initTransform",value:function(){for(var t=0;t<this._particles.length;t++){var i=this._particles[t];null!=i.node&&(i.node.setPosition(i.initLocalPosition),i.node.setRotation(i.initLocalRotation))}}},{key:"resetParticlesPosition",value:function(){for(var t=j.get(),i=0;i<this._particles.length;i++){var e=this._particles[i];if(e.node)e.node.getWorldPosition(e.position),e.prevPosition.set(e.position);else{var o=this._particles[e.parent].node;P.transformMat4(t,e.endOffset,o.worldMatrix),e.position.set(t),e.prevPosition.set(t)}}this._objectPrePosition.set(this.node.worldPosition),j.put(t)}},{key:"updateParticles1",value:function(){var t=j.get();t.set(this.gravity);var i=j.get(t);i.normalize();var e=j.get();R(e,this._localGravity,this.root.worldMatrix);var o=j.get();O(o,e,i),t.subtract(o),t.add(this.force).multiplyScalar(this._objectScale);for(var r=0;r<this._particles.length;r++){var n=this._particles[r];if(n.parent>=0){var s=j.get(n.position);s.subtract(n.prevPosition);var a=j.get(this._objectMove).multiplyScalar(n.inert);n.prevPosition.set(n.position).add(a),s.multiplyScalar(1-n.damping).add(t).add(a),n.position.add(s),j.put(s),j.put(a)}else n.prevPosition.set(n.position),n.position.set(n.node.worldPosition)}j.puts(t,i,e,o)}},{key:"updateParticles2",value:function(){for(var t=1;t<this._particles.length;t++){var i=this._particles[t],e=this._particles[i.parent],o=0;if(i.node)o=P.distance(i.node.worldPosition,e.node.worldPosition);else{var r=j.get();R(r,i.endOffset,e.node.worldMatrix),o=r.length(),j.put(r)}var n=w.lerp(1,i.stiffness,this._weight);if(n>0||i.elasticity>0){var s=E.get(e.node.worldMatrix);s.m12=e.position.x,s.m13=e.position.y,s.m14=e.position.z,s.m15=0;var a=j.get();i.node?P.transformMat4(a,i.node.position,s):P.transformMat4(a,i.endOffset,s);var l=j.get(a).subtract(i.position),d=j.get(l).multiplyScalar(i.elasticity);if(i.position.add(d),n>0){l.set(a).subtract(i.position);var c=l.length(),u=o*(1-n)*2;c>u&&i.position.add(l.multiplyScalar((c-u)/c))}j.puts(l,d,a),E.put(s)}if(this.colliders.length>0)for(var p=i.radius*this._objectScale,h=0;h<this.colliders.length;h++){var f=this.colliders[h];f&&f.node&&f.enabled&&f.collide(i.position,i.position,p)}if(this.freezeAxis!=I.None){switch(this.freezeAxis){case I.X:Lt.setNormalAndPosition(e.node.right,e.position);break;case I.Y:Lt.setNormalAndPosition(e.node.up,e.position);break;case I.Z:Lt.setNormalAndPosition(e.node.forward,e.position)}var v=j.get(i.position).subtract(e.position).normalize(),b=P.angle(v,Lt.normal);if(Math.abs(b%Math.PI)>.01){var g=j.get(Lt.normal);g.multiplyScalar(Lt.getDistanceToPoint(i.position)),i.position.subtract(g),j.put(g)}j.put(v)}var _=j.get(e.position).subtract(i.position),m=_.length();m>0&&!w.equals(m,o)&&i.position.add(_.multiplyScalar((m-o)/m)),j.put(_)}}},{key:"skipUpdateParticles",value:function(){for(var t=0;t<this._particles.length;t++){var i=this._particles[t];if(i.parent>=0){i.prevPosition.add(this._objectMove),i.position.add(this._objectMove);var e=this._particles[i.parent],o=0;if(i.node)o=P.distance(e.node.worldPosition,i.node.worldPosition);else{var r=j.get(i.endOffset);R(r,r,e.node.worldMatrix),o=P.len(r),j.put(r)}var n=w.lerp(1,i.stiffness,this._weight);if(n>0){var s=E.get(e.node.worldMatrix);s.m12=e.position.x,s.m13=e.position.y,s.m14=e.position.z,s.m15=0;var a=j.get();i.node?P.transformMat4(a,i.node.position,s):P.transformMat4(a,i.endOffset,s);var l=a.subtract(i.position),d=P.len(l),c=o*(1-n)*2;d>c&&i.position.add(l.multiplyScalar((d-c)/d)),j.put(a),E.put(s)}var u=j.get(e.position);u.subtract(i.position);var p=P.len(u);p>0&&!w.equals(p,o)&&i.position.add(u.multiplyScalar((p-o)/p)),j.put(u)}else i.prevPosition.set(i.position),i.position.set(i.node.worldPosition)}}},{key:"applyParticlesToTransforms",value:function(){for(var t=1;t<this._particles.length;t++){var i=this._particles[t],e=this._particles[i.parent];if(e.node.children.length<=1){var o=j.get();i.node?o.set(i.node.position):o.set(i.endOffset);var r=j.get(i.position).subtract(e.position);r.normalize(),R(o,o,e.node.worldMatrix),o.normalize();var n=x.get();D.rotationTo(n,o,r),D.multiply(n,n,e.node.worldRotation),e.node.setWorldRotation(n),j.put(o),j.put(r),x.put(n)}i.node&&i.node.setWorldPosition(i.position)}}},{key:"weight",get:function(){return this._weight},set:function(t){this._weight!=t&&(this._weight=t,0==t?this.initTransform():this.resetParticlesPosition(),this._weight=t)}}]),i}(z)).prototype,"root",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ct=e(lt.prototype,"updateRate",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 60}}),ut=e(lt.prototype,"damping",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),pt=e(lt.prototype,"dampingDistrib",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v}}),ht=e(lt.prototype,"elasticity",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),ft=e(lt.prototype,"elasticityDistrib",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v}}),vt=e(lt.prototype,"stiffness",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),bt=e(lt.prototype,"stiffnessDistrib",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v}}),gt=e(lt.prototype,"inert",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),_t=e(lt.prototype,"inertDistrib",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v}}),mt=e(lt.prototype,"radius",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),yt=e(lt.prototype,"radiusDistrib",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v}}),Pt=e(lt.prototype,"endNode",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wt=e(lt.prototype,"endOffset",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g()}}),Dt=e(lt.prototype,"gravity",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g()}}),zt=e(lt.prototype,"force",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g()}}),kt=e(lt.prototype,"freezeAxis",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return I.None}}),Mt=e(lt.prototype,"colliders",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),jt=e(lt.prototype,"excludeNodes",[it],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Et=e(lt.prototype,"distantDisable",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xt=e(lt.prototype,"refenceObject",[ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ct=e(lt.prototype,"distanceToObject",[rt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),Rt=e(lt.prototype,"enableEditorDebug",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ot=e(lt.prototype,"showDebugGizmos",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),at=lt))||at)||at)),Lt=new T,u._RF.pop()}}}));

System.register("chunks:///framework/DynamicBone/DynamicBoneCollider.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./Pool.js","./Utils.js","./Enums.js","./DynamicBoneColliderBase.js"],(function(t,e){var r,a,i,s,o,l,u,n,c,d,h,p,g,f,v,y,m,b,S,M,q,C,w,k,_,x,D,B,z,E,P,R,j;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(t){r=t.applyDecoratedDescriptor,a=t.inherits,i=t.classCallCheck,s=t.possibleConstructorReturn,o=t.getPrototypeOf,l=t.initializerDefineProperty,u=t.assertThisInitialized,n=t.createClass},function(t){c=t.cclegacy,d=t._decorator,h=t.Vec3,p=t.Quat,g=t.Mat4,f=t.director,v=t.Color},function(t){y=t.Vec3Pool,m=t.Mat4Pool,b=t.QuatPool},function(t){S=t.rotateQ},function(t){M=t.EBound,q=t.EDirection},function(t){C=t.DynamicBoneColliderBase}],execute:function(){c._RF.push({},"a167e38H3VJKrYSXoJ2UHwl","DynamicBoneCollider",void 0),E=d.ccclass,P=d.property,R=d.executeInEditMode,d.disallowMultiple,j=window.CC_EDITOR,t("DynamicBoneCollider",(w=E("DynamicBoneCollider"),k=P({tooltip:"半径"}),_=P({tooltip:"高度"}),w(x=R((B=r((D=function(t){function e(){var t,r;i(this,e);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return r=s(this,(t=o(e)).call.apply(t,[this].concat(n))),l(r,"radius",B,u(r)),l(r,"height",z,u(r)),r}return a(e,t),n(e,[{key:"update",value:function(t){j&&(this.radius=Math.max(this.radius,0),this.height=Math.max(this.height,0))}},{key:"collide",value:function(t,r,a){this.ignoreTargetRadius&&(a=0);var i=this.radius*Math.abs(this.node.scale.x);if(i<=0){var s=y.get();h.transformMat4(s,this.center,this.node.worldMatrix),this.bound==M.Outside?e.outsideSphere(t,r,a,s,i):e.insideSphere(t,r,a,s,i),y.put(s)}else{var o=y.get(this.center),l=y.get(this.center),u=.5*this.height;switch(this.direction){case q.X:o.x-=u,l.x+=u;break;case q.Y:o.y-=u,l.y+=u;break;case q.Z:o.z-=u,l.z+=u}var n=m.get(this.node.worldMatrix);if(!this.rotate.equals3f(0,0,0)){var c=y.get();h.transformMat4(c,this.center,this.node.worldMatrix);var d=p.fromEuler(b.get(),this.rotate.x,this.rotate.y,this.rotate.z),f=m.get();S(f,d,c),g.multiply(n,f,n),m.put(f),y.put(c),b.put(d)}var v=y.get();h.transformMat4(v,o,n);var C=y.get();h.transformMat4(C,l,n),this.bound==M.Outside?e.outsideCapsule(t,r,a,v,C,i):e.insideCapsule(t,r,a,v,C,i),y.puts(v,C,o,l),m.put(n)}return t}},{key:"applyRotate",value:function(t,e){if(!this.rotate.equals3f(0,0,0)){var r=p.fromEuler(b.get(),this.rotate.x,this.rotate.y,this.rotate.z),a=m.get();S(a,r,e),t.multiply(a),m.put(a),b.put(r)}}},{key:"debugDraw",value:function(){var t=f.root.pipeline.geometryRenderer;if(t){var e=null;switch(this.direction){case q.X:e=this.node.right;break;case q.Y:e=this.node.up;break;case q.Z:e=this.node.forward}var r=m.get(),a=y.get(this.center);h.transformMat4(a,a,this.node.worldMatrix);var i=b.get();p.rotationTo(i,h.UP,e),S(r,i,a),this.applyRotate(r,a),t.addCapsule(a,this.radius,this.height,v.YELLOW,12,12,!0,!0,!0,!0,r),y.put(a),m.put(r),b.put(i)}}}],[{key:"outsideSphere",value:function(t,e,r,a,i){var s=i+r,o=s*s,l=y.get(e).subtract(a),u=l.lengthSqr();if(u>0&&u<o){var n=Math.sqrt(u),c=y.get(l).multiplyScalar(s/n).add(a);t.set(c),y.put(c)}return y.put(l),t}},{key:"insideSphere",value:function(t,e,r,a,i){var s=i-r,o=s*s,l=y.get(e).subtract(a),u=l.lengthSqr();if(u>o){var n=Math.sqrt(u),c=y.get(l).multiplyScalar(s/n).add(a);t.set(c),y.put(c)}return y.put(l),t}},{key:"outsideCapsule",value:function(t,e,r,a,i,s){var o=s+r,l=o*o,u=y.get(i).subtract(a),n=y.get(e).subtract(a),c=n.dot(u);if(c<=0){var d=n.lengthSqr();if(d>0&&d<l){var h=Math.sqrt(d),p=y.get(n).multiplyScalar(o/h).add(a);t.set(p),y.put(p)}}else{var g=u.lengthSqr();if(c>=g){var f=(n=y.get(e).subtract(i)).lengthSqr();if(f>0&&f<l){var v=Math.sqrt(f),m=y.get(n).multiplyScalar(o/v).add(i);t.set(m),y.put(m)}}else if(g>0){c/=g,n.subtract(u.multiplyScalar(c));var b=n.lengthSqr();if(b>0&&b<l){var S=Math.sqrt(b),M=y.get(n).multiplyScalar((o-S)/S).add(e);t.set(M),y.put(M)}}}return y.puts(n,u),t}},{key:"insideCapsule",value:function(t,e,r,a,i,s){var o=s-r,l=o*o,u=y.get(i).subtract(a),n=y.get(e).subtract(a),c=n.dot(u);if(c<=0){var d=n.lengthSqr();if(d>l){var h=Math.sqrt(d),p=y.get(n).multiplyScalar(o/h).add(a);t.set(p),y.put(p)}}else{var g=u.lengthSqr();if(c>=g){var f=(n=y.get(e).subtract(i)).lengthSqr();if(f>l){var v=Math.sqrt(f),m=y.get(n).multiplyScalar(o/v).add(i);t.set(m),y.put(m)}}else if(g>0){c/=g,n.subtract(u.multiplyScalar(c));var b=n.lengthSqr();if(b>l){var S=Math.sqrt(b),M=y.get(n).multiplyScalar((o-S)/S).add(e);t.set(M),y.put(M)}}}return y.puts(n,u),t}}]),e}(C)).prototype,"radius",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),z=r(D.prototype,"height",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),x=D))||x)||x)),c._RF.pop()}}}));

System.register("chunks:///DynamicBoneComp.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./framework/DynamicBone/DynamicBone.js","./framework/DynamicBone/DynamicBoneCollider.js"],(function(i,e){var o,n,p,t,a,s,d,r,l,h,B,m,C,c,v;return i({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(i){o=i.inherits,n=i.classCallCheck,p=i.possibleConstructorReturn,t=i.getPrototypeOf,a=i.createClass},function(i){s=i.cclegacy,d=i._decorator,r=i.Vec3,l=i.Node,h=i.Component},function(i){B=i.DynamicBone},function(i){m=i.DynamicBoneCollider}],execute:function(){s._RF.push({},"69786N3S99EHqFuP0+EtB0x","DynamicBoneComp",void 0),v=d.ccclass,d.property,i("DynamicBoneComp",(C=v("DynamicBoneComp"),C(c=function(i){function e(){var i,o;n(this,e);for(var a=arguments.length,s=new Array(a),d=0;d<a;d++)s[d]=arguments[d];return(o=p(this,(i=t(e)).call.apply(i,[this].concat(s)))).rootNode=null,o.rClavicleNode=null,o.lClavicleNode=null,o.rArmNode=null,o.lArmNode=null,o.rForearmNode=null,o.lForearmNode=null,o.rhandNode=null,o.lhandNode=null,o.rChestNode=null,o.lChestNode=null,o.rLegNode=null,o.lLegNode=null,o.commonColliderComp=[],o.femaleHairs20002Comp=[],o.femaleHairs20006Comp=[],o.femaleHairs20008Comp=[],o.femaleHairs60002Comp=[],o}return o(e,i),a(e,[{key:"onLoad",value:function(){this.init()}},{key:"init",value:function(){this.initData(),this.addFemaleHairs60002(),this.addFemaleHairs20008(),this.addFemaleHairs20002(),this.addFemaleHairs20006()}},{key:"initData",value:function(){this.rootNode=this.node.getChildByName("RootNode"),this.addBoneColliderComp()}},{key:"addBoneColliderComp",value:function(){this.rClavicleNode=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 R Clavicle");var i=this.rClavicleNode.addComponent(m);i.center=new r(0,.1,.1),i.radius=.1,i.height=.2,this.commonColliderComp.push(i),this.lClavicleNode=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 R Clavicle");var e=this.lClavicleNode.addComponent(m);e.center=new r(.05,0,0),e.radius=.08,e.height=.1,this.commonColliderComp.push(e),this.rArmNode=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 R Clavicle/Bip001 R UpperArm");var o=this.rArmNode.addComponent(m);o.center=new r(0,0,.1),o.radius=.1,o.height=.2,this.commonColliderComp.push(o),this.lArmNode=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 L Clavicle/Bip001 L UpperArm");var n=this.lArmNode.addComponent(m);n.center=new r(.1,0,0),n.radius=.1,n.height=.2,this.commonColliderComp.push(n),this.lForearmNode=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 L Clavicle/Bip001 L UpperArm/Bip001 L Forearm");var p=this.lForearmNode.addComponent(m);p.center=new r(0,0,0),p.radius=.08,p.height=.2,this.commonColliderComp.push(p),this.rForearmNode=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 R Clavicle/Bip001 R UpperArm/Bip001 R Forearm");var t=this.rForearmNode.addComponent(m);t.center=new r(0,0,.15),t.radius=.2,t.height=.1,this.commonColliderComp.push(t),this.lhandNode=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 L Clavicle/Bip001 L UpperArm/Bip001 L Forearm/Bip001 L Hand");var a=this.lhandNode.addComponent(m);a.center=new r(0,0,0),a.radius=.08,a.height=.2,this.commonColliderComp.push(a),this.rhandNode=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 R Clavicle/Bip001 R UpperArm/Bip001 R Forearm/Bip001 R Hand");var s=this.rhandNode.addComponent(m);s.center=new r(0,0,0),s.radius=.08,s.height=.2,this.commonColliderComp.push(s),this.rChestNode=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bone54");var d=this.rChestNode.addComponent(m);d.center=new r(0,0,0),d.radius=.1,d.height=0,this.commonColliderComp.push(d),this.lChestNode=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bone55");var l=this.lChestNode.addComponent(m);l.center=new r(0,0,0),l.radius=.1,l.height=0,this.commonColliderComp.push(l),this.rLegNode=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 R Thigh");var h=this.rLegNode.addComponent(m);h.center=new r(.1,.08,0),h.radius=.1,h.height=.2,this.commonColliderComp.push(h)}},{key:"addFemaleHairs20008",value:function(){var i=new l("Bone22");i.parent=this.rootNode;var e=i.addComponent(B),o=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/Bone22"),n=this.commonColliderComp;this.femaleHairs20008Comp.push(e),this.initDynamicBoneComp(e,o,n);var p=new l("Bone27");p.parent=this.rootNode;var t=p.addComponent(B),a=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/Bone27"),s=this.commonColliderComp;this.femaleHairs20008Comp.push(t),this.initDynamicBoneComp(t,a,s),t.damping=.8;var d=new l("Bone32");d.parent=this.rootNode;var r=d.addComponent(B),h=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/Bone32"),m=this.commonColliderComp;this.femaleHairs20008Comp.push(r),this.initDynamicBoneComp(r,h,m);var C=new l("Bone41");C.parent=this.rootNode;var c=C.addComponent(B),v=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/Bone41"),N=this.commonColliderComp;this.femaleHairs20008Comp.push(c),this.initDynamicBoneComp(c,v,N)}},{key:"addFemaleHairs60002",value:function(){var i=new l("rClavicleNode");i.parent=this.rootNode;var e=i.addComponent(B),o=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/asd06"),n=this.commonColliderComp;this.femaleHairs60002Comp.push(e),this.initDynamicBoneComp(e,o,n);var p=new l("lClavicleNode");p.parent=this.rootNode;var t=p.addComponent(B),a=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/asd12"),s=this.commonColliderComp;this.femaleHairs60002Comp.push(s),this.initDynamicBoneComp(t,a,s)}},{key:"addFemaleHairs20002",value:function(){var i=new l("Bone025");i.parent=this.rootNode;var e=i.addComponent(B),o=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/Bone025"),n=this.commonColliderComp;this.femaleHairs20002Comp.push(e),this.initDynamicBoneComp(e,o,n)}},{key:"addFemaleHairs20006",value:function(){var i=new l("jinfaBone03");i.parent=this.rootNode;var e=i.addComponent(B),o=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/jinfaBone01/jinfaBone02/jinfaBone03"),n=this.commonColliderComp;this.femaleHairs20006Comp.push(e),this.initDynamicBoneComp(e,o,n);var p=new l("jinfaBone10");p.parent=this.rootNode;var t=p.addComponent(B),a=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/jinfaBone08/jinfaBone09/jinfaBone10"),s=this.commonColliderComp;this.femaleHairs20006Comp.push(t),this.initDynamicBoneComp(t,a,s);var d=new l("jinfaBone18");d.parent=this.rootNode;var r=d.addComponent(B),h=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/jinfaBone16/jinfaBone17/jinfaBone18"),m=this.commonColliderComp;this.femaleHairs20006Comp.push(r),this.initDynamicBoneComp(r,h,m);var C=new l("jinfaBone23");C.parent=this.rootNode;var c=C.addComponent(B),v=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/jinfaBone23"),N=this.commonColliderComp;this.femaleHairs20006Comp.push(c),this.initDynamicBoneComp(c,v,N);var u=new l("jinfaBone029");u.parent=this.rootNode;var f=u.addComponent(B),S=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/jinfaBone027/jinfaBone028/jinfaBone029"),y=this.commonColliderComp;this.femaleHairs20006Comp.push(f),this.initDynamicBoneComp(f,S,y);var H=new l("jinfaBone034");H.parent=this.rootNode;var g=H.addComponent(B),P=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/jinfaBone034"),R=this.commonColliderComp;this.femaleHairs20006Comp.push(g),this.initDynamicBoneComp(g,P,R);var k=new l("jinfaBone41");k.parent=this.rootNode;var w=k.addComponent(B),D=this.node.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head/jinfaBone41"),j=this.commonColliderComp;this.femaleHairs20006Comp.push(w),this.initDynamicBoneComp(w,D,j)}},{key:"initDynamicBoneComp",value:function(i,e,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.ZERO;i.root=e,i.damping=.3,i.radius=.01,i.force=n,i.colliders=o,i.setup()}},{key:"openCheck",value:function(i){for(var e=0;e<this.femaleHairs20002Comp.length;e++)this.femaleHairs20002Comp[e].isOpen=!1;for(var o=0;o<this.femaleHairs20006Comp.length;o++)this.femaleHairs20006Comp[o].isOpen=!1;for(var n=0;n<this.femaleHairs20008Comp.length;n++)this.femaleHairs20008Comp[n].isOpen=!1;for(var p=0;p<this.femaleHairs60002Comp.length;p++)this.femaleHairs60002Comp[p].isOpen=!1;if("20002"==i)for(var t=0;t<this.femaleHairs20002Comp.length;t++)this.femaleHairs20002Comp[t].isOpen=!0;else if("20008"==i)for(var a=0;a<this.femaleHairs20008Comp.length;a++)this.femaleHairs20008Comp[a].isOpen=!0;else if("20006"==i)for(var s=0;s<this.femaleHairs20006Comp.length;s++)this.femaleHairs20006Comp[s].isOpen=!0;else for(var d=0;d<this.femaleHairs60002Comp.length;d++)this.femaleHairs60002Comp[d].isOpen=!0}}]),e}(h))||c)),s._RF.pop()}}}));

System.register("chunks:///AvatarMgr.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./Define.js","./framework/base64.js","./framework/event/clientEvent.js","./framework/sdk/SDK.js","./morphContrl.js","./framework/data/GlobalData.js","./framework/logger.js","./hotupdate/HotUpdate.js","./framework/manager/AssetsManager.js","./framework/config/localConfigMgr.js","./GUI.js","./DynamicBoneComp.js"],(function(e,t){var o,a,n,i,s,r,l,d,h,c,g,u,f,y,m,p,C,v,N,b,R,S,A,B,_,E,k,x,P,w,T,O,I,G,M,J,D,L,U,V,H,F,j,K,Y,Z,z,W,X,q,Q,$,ee,te,oe,ae,ne,ie,se;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){o=e.applyDecoratedDescriptor,a=e.inherits,n=e.classCallCheck,i=e.possibleConstructorReturn,s=e.getPrototypeOf,r=e.initializerDefineProperty,l=e.assertThisInitialized,d=e.createClass,h=e.asyncToGenerator},function(e){c=e.cclegacy,g=e._decorator,u=e.Camera,f=e.Node,y=e.Vec3,m=e.Prefab,p=e.instantiate,C=e.SkeletalAnimation,v=e.tween,N=e.Color,b=e.ModelComponent,R=e.Material,S=e.Texture2D,A=e.math,B=e.Component,_=e.SkinnedMeshRenderer},function(e){E=e.RoleSex,k=e.BoyConfig,x=e.GirlConfig,P=e.ZDBoyConfig,w=e.ZDGirlConfig,T=e.GameRes,O=e.EventName,I=e.SDKCallStaticMethodName,G=e.ChangeProgressName,M=e.ARKitJSON,J=e.FacePart,D=e.EyeBrowPart},function(e){L=e.default},function(e){U=e.EVT},function(e){V=e.SDK},function(e){H=e.MorphContrl},function(e){F=e.GD},function(e){j=e.Logger},function(e){K=e.HotUpdate},function(e){Y=e.AM},function(e){Z=e.ConfigMgr},function(e){z=e.GUI},function(e){W=e.DynamicBoneComp}],execute:function(){c._RF.push({},"00778+ZFdRIVaFy2zQX1skh","AvatarMgr",void 0),ae=g.ccclass,ne=g.property,ie=window.jsb,se=["10001","10002","30002"],e("AvatarMgr",(X=ae("AvatarMgr"),q=ne(u),Q=ne(f),X((te=o((ee=function(e){function t(){var e,o;n(this,t);for(var a=arguments.length,d=new Array(a),h=0;h<a;h++)d[h]=arguments[h];return o=i(this,(e=s(t)).call.apply(e,[this].concat(d))),r(o,"mainCamera",te,l(o)),r(o,"roleRootNode",oe,l(o)),o.roleNode=null,o.isLoading=!1,o.roleMap=new Map,o.gameJson={data:null,config:null},o.roleConfig={},o.sex=E.Boy,o.bodyNode=null,o.headNode=null,o.neckNode=null,o.faceNode=null,o.eyeBrowNode=null,o.eyelashNode=null,o.headAngle=y.ZERO,o.neckAngle=y.ZERO,o.bodyAngle=y.ZERO,o.hotUpdateCtrl=null,o.palyAnim=!1,o.base64=new L,o.GUI=null,o.boyConfig=k,o.girlConfig=x,o.recoverFaceId=0,o.recoverHeadId=0,o}return a(t,e),d(t,[{key:"onLoad",value:function(){this.init(),this.hotUpdateCtrl=this.node.getComponent(K),ie&&V.sendToNative("onStateChanged",{type:1,state:2}),this.node.getChildByName("debug").active=F.openDebug,F.openDebug&&this.preLoadRes()}},{key:"init",value:function(){this.initLister(),this.GUI=this.node.getComponent(z),F.GM=this}},{key:"initGame",value:function(e){var t=e;if("string"==typeof e&&(t=JSON.parse(e)),this.boyConfig="1"==t.config.areaState?k:P,this.girlConfig="1"==t.config.areaState?x:w,t.data&&""!=t.data){var o=this.base64.base64decode(t.data);this.gameJson.data=JSON.parse(o)}else"1"==t.config.accountSex?(this.gameJson.data=this.boyConfig,this.sex=E.Boy):(this.gameJson.data=this.girlConfig,this.sex=E.Girl);"1.0.0"==F.version?"10001"!=this.gameJson.data.role.id&&"10002"!=this.gameJson.data.role.id||("1"==t.config.accountSex?(this.gameJson.data=this.boyConfig,this.sex=E.Boy):(this.gameJson.data=this.girlConfig,this.sex=E.Girl)):"1001"!=this.gameJson.data.role.id&&"1002"!=this.gameJson.data.role.id||("1"==t.config.accountSex?(this.gameJson.data=this.boyConfig,this.sex=E.Boy):(this.gameJson.data=this.girlConfig,this.sex=E.Girl)),F.WritablePath=t.config.saveErrorLogPath,"1"==t.config.autoUpdateEnable&&this.hotUpdateCtrl.checkUpdate(),this.initData()}},{key:"initData",value:function(e){F.openDebug&&(this.gameJson.data=this.girlConfig,this.sex=E.Girl),this.sex==E.Girl?this.mainCamera.node.setPosition(0,1.25,1.9):this.mainCamera.node.setPosition(0,1.35,1.9),ie&&!F.openDebug&&this.preLoadRes()}},{key:"loadConfig",value:function(){Z.loadConfig((function(){}),this.onLoadConfigFinish.bind(this))}},{key:"preLoadRes",value:function(){Y.loadGameRes(T,{cb:this.onLoadResFinish.bind(this),trigger:this.onLoadResProgress.bind(this)})}},{key:"onLoadResProgress",value:function(e,t){}},{key:"onLoadResFinish",value:function(){this.loadConfig()}},{key:"onLoadConfigFinish",value:function(){var e=this;F.openDebug&&this.initData(),this.roleConfig=Z.getTable("role"),this.gameJson.data.body.every((function(t,o){return e.roleConfig[t.id]}))||(this.sex==E.Boy?(this.gameJson.data=k,this.sex=E.Boy):(this.gameJson.data=x,this.sex=E.Girl)),this.sex=this.roleConfig[this.gameJson.data.role.id].sex,this.initRole(),F.openDebug&&this.GUI.initDebugUI()}},{key:"initRole",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.palyAnim=!1,this.isLoading=!0,this.roleNode=null,this.faceNode=null,this.eyelashNode=null,this.eyeBrowNode=null,this.roleMap.forEach((function(t,o){se.includes(o)||(Y.releaseAsset("textures/".concat(e.roleConfig[o].resName,"/N/texture")),Y.releaseAsset("textures/".concat(e.roleConfig[o].resName,"/D/texture")),Y.releaseAsset("prefab/".concat(e.roleConfig[o].resName))),t.destroy()})),this.roleMap.clear(),this.onSetBg(Number(this.gameJson.data.bgId),!0);var o=this.roleConfig[this.gameJson.data.role.id];this.loadRes({url:"prefab/".concat(o.resName),type:m,id:o.id},(function(o,a){if(o)e.isLoading=!1;else{var n=p(a);e.sex==E.Girl&&n.addComponent(W),e.roleNode=n,e.roleRootNode.addChild(n),n.active=!1,""!=e.gameJson.data.role.extra.colorId&&e.setBodyColor(n,e.gameJson.data.role.extra.colorId,!0,e.gameJson.data.role.id),e.headNode=n.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck/Bip001 Head"),e.neckNode=n.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2/Bip001 Neck"),e.bodyNode=n.getChildByPath("RootNode/Bip001/Bip001 Pelvis/Bip001 Spine/Bip001 Spine1/Bip001 Spine2"),e.sex==E.Girl?(e.faceNode=n.getChildByPath("RootNode/female_head_head_base"),e.eyeBrowNode=n.getChildByPath("RootNode/female_head_eyebrow_base"),e.eyelashNode=n.getChildByPath("RootNode/female_head_eyelash_base")):(e.faceNode=n.getChildByPath("RootNode/male_body_head_male"),e.eyeBrowNode=n.getChildByPath("RootNode/male_body_eyebrow_male"),e.eyelashNode=n.getChildByPath("RootNode/male_body_eyelash_male")),e.faceNode.addComponent(H),e.eyeBrowNode.addComponent(H),e.eyelashNode.addComponent(H),e.roleMap.set(e.gameJson.data.role.id.toString(),n);for(var i=0,s=function(o){var a=e.gameJson.data.body[o],s=e.roleConfig[a.id];s.sex!=e.sex?i++:e.loadRes({url:"prefab/".concat(null==s?void 0:s.resName),type:m,id:a.id},function(){var r=h(regeneratorRuntime.mark((function r(l,d){var h,c,g,u;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!l){r.next=2;break}return r.abrupt("return");case 2:h=p(d),(c=h.getComponentInChildren(_)).skinningRoot=e.roleNode,e.sex==E.Girl&&"hairs"==s.resKey&&n.getComponent(W).openCheck(a.id),g=c.materials,u=0;case 8:if(!(u<g.length)){r.next=16;break}return r.next=11,e.setMaterial(g[u],"textures/".concat(null==s?void 0:s.resName),u,"30002"==a.id);case 11:r.sent==g.length-1&&(i++,e.roleRootNode.addChild(h),h.active=!1,""!=a.extra.colorId&&e.setBodyColor(h,a.extra.colorId,!1,a.id),i==e.gameJson.data.body.length&&(e.roleRootNode.children.forEach((function(e){e.active=!0})),e.isLoading=!1,e.roleNode.active=!0,t||V.sendToNative(I.onRoleSettingsCallback,{setStatus:G.SexSucc}),e.roleNode.getComponent(C).play("idle")));case 13:u++,r.next=8;break;case 16:e.roleMap.set(e.gameJson.data.body[o].id.toString(),h);case 17:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())},r=0;r<e.gameJson.data.body.length;r++)s(r)}}))}},{key:"initLister",value:function(){j.addWindowsErrLister(),U.on(O.EVT_CHANGEBG,this.onSetBg,this),U.on(O.EVT_GAMEINIT,this.initGame,this),U.on(O.EVT_HOTUPDATE,this.hotUpdate,this),U.on(O.EVT_BODYANIM,this.playRoleAnim,this),U.on(O.EVT_ROTATEROLE,this.onRotateRole,this),U.on(O.EVT_SCREENSHOT,this.onScreenShot,this),U.on(O.EVT_GETGAMEDATA,this.getGameData,this),U.on(O.EVT_CHANGEROLE,this.onChangleRole,this),U.on(O.EVT_ARKIT,this.onPlayRoleFaceAnim,this),U.on(O.EVT_BODYCHANGE,this.onChangeBodyPart,this),U.on(O.EVT_CHANGESROLECALE,this.onSetRoleScale,this),U.on(O.EVT_BODYCOLORCHANGE,this.onSetBodyPartColor,this),U.on(O.EVT_ALREADYUPTODATE,this.initData,this),this.node.on(f.EventType.TOUCH_MOVE,this.onTouchMove,this)}},{key:"onTouchMove",value:function(e){this.onRotateRole(e.getDelta().x)}},{key:"playRoleAnim",value:function(e){var t=this;if(!this.palyAnim){var o=!1,a=this.mainCamera.node.position.clone();this.roleNode.getComponent(C).once("finished",(function(){o?v(t.mainCamera.node).to(1,{position:a}).call((function(){t.palyAnim=!1})).start():t.palyAnim=!1,t.roleNode.getComponent(C).play("idle")}),this);var n=this.roleConfig[e].resName;"crazyGesture"==n?(o=!0,v(this.mainCamera.node).to(1,{position:new y(0,1,3)}).call((function(){t.palyAnim=!0,t.roleNode.getComponent(C).play(n)})).start()):(this.palyAnim=!0,this.roleNode.getComponent(C).play(n))}}},{key:"onRotateRole",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.GUI.rotateRole(e,t)}},{key:"onSetRoleScale",value:function(e){console.log("dwx  onSetRoleScale: ".concat(e)),this.GUI.setRoleScale(e)}},{key:"hotUpdate",value:function(e){var t=e;"string"==typeof e&&(t=JSON.parse(e)),1==t.state?this.hotUpdateCtrl.hotUpdate():(console.log("取消更新 直接加载"),this.gameJson&&this.initData(this.gameJson))}},{key:"onChangeBodyPart",value:function(e){var t=[],o=[];if(F.openDebug)this.roleMap.has(e)||this.addBodyPart(e);else{var a=JSON.parse(e);if(a.hasOwnProperty("addBodyId")){o=a.addBodyId;for(var n=0;n<o.length;n++){"background"==this.roleConfig[o[n].toString()].resKey?this.onSetBg(o[n],!1):this.addBodyPart(o[n].toString())}}if(a.hasOwnProperty("subBodyId")){t=a.subBodyId;for(var i=0;i<t.length;i++){"background"==this.roleConfig[t[i].toString()].resKey?this.onSetBg(t[i],!1):this.subBodyPart(t[i].toString())}}}}},{key:"onSetBg",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.GUI.setBg(e,t)}},{key:"addBodyPart",value:function(e){var t=this;console.log("addBodyPart---------------".concat(e));var o=this.roleConfig[e];if(o.sex!=this.sex)return V.sendToNative(I.onRoleSettingsCallback,{setStatus:G.SexFail}),void console.log("sex diff");if(o){if(!this.roleMap.has(e)){var a="prefab/".concat(null==o?void 0:o.resName);this.loadRes({url:a,type:m,id:e},function(){var a=h(regeneratorRuntime.mark((function a(n,i){var s,r,l,d,h;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!n){a.next=2;break}return a.abrupt("return");case 2:s=p(i),(r=s.getComponentInChildren(_)).skinningRoot=t.roleNode,t.sex==E.Girl&&"hairs"==o.resKey&&t.roleNode.getComponent(W).openCheck(o.id),l=r.materials,d=0;case 8:if(!(d<l.length)){a.next=16;break}return a.next=11,t.setMaterial(l[d],"textures/".concat(null==o?void 0:o.resName),d,"30002"==e);case 11:a.sent==l.length-1&&(V.sendToNative(I.onRoleSettingsCallback,{setStatus:G.BodySucc}),t.roleRootNode.addChild(s));case 13:d++,a.next=8;break;case 16:h={id:e,extra:{colorId:"0"}},t.roleMap.forEach((function(a,n){var i=t.roleConfig[n];i.resKey==o.resKey&&i.id!=e&&i.sex==t.sex&&t.subBodyPart(n)})),t.gameJson.data.body.push(h),t.roleMap.set(e,s);case 20:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())}}else console.log("body data is null~")}},{key:"subBodyPart",value:function(e){console.log("subBodyPart---------------".concat(e)),this.roleMap.get(e)&&(this.gameJson.data.body=this.gameJson.data.body.filter((function(t){return t.id!=e})),this.roleMap.get(e).destroy(),this.roleMap.delete(e),se.includes(e)||(Y.releaseAsset("textures/".concat(this.roleConfig[e].resName,"/N/texture")),Y.releaseAsset("textures/".concat(this.roleConfig[e].resName,"/D/texture")),Y.releaseAsset("prefab/".concat(this.roleConfig[e].resName))))}},{key:"onSetBodyPartColor",value:function(e){var t,o=JSON.parse(e),a=o.bodyId;if(t=this.roleMap.get(a.toString())){t&&"0"==o.type&&("0"==o.colorId&&(o.colorId=""),"role"==this.roleConfig[a].resKey?this.gameJson.data.role.extra.colorId=o.colorId:this.gameJson.data.body.forEach((function(e){e.id==a&&(e.extra.colorId=o.colorId)})));var n="10001"==a||"10002"==a;this.setBodyColor(t,o.colorId,n,a)}}},{key:"setBodyColor",value:function(e,t){var o,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e,i=null;if(n){var s,r=new N;s="0"==t||""==t?"#FFFFFF":this.roleConfig[t].resName,i=r.fromHEX(s)}var l=[];if(a){var d=null,h=null,c=null;this.sex==E.Boy?(d=n.getChildByPath("RootNode/male_body_head_male").getComponent(b),h=n.getChildByPath("RootNode/male_body_body_base").getComponent(b),c=n.getChildByPath("RootNode/male_body_eyebrow_male").getComponent(b)):(d=n.getChildByPath("RootNode/female_head_head_base").getComponent(b),h=n.getChildByPath("RootNode/female_body_body_base").getComponent(b),c=n.getChildByPath("RootNode/female_head_eyebrow_base").getComponent(b)),l=l.concat(d,h,c)}else l=n.getComponentsInChildren(b);var g="";g=this.sex==E.Boy?"male_body_head_male":"female_head_head_base",null===(o=l)||void 0===o||o.forEach((function(e){e.materials.forEach((function(t,o){e.node.name==g?0==o&&t.setProperty("mainColor",i):t.setProperty("mainColor",i)}))})),V.sendToNative(I.onRoleSettingsCallback,{setStatus:G.ColorSucc})}},{key:"update",value:function(e){}},{key:"lateUpdate",value:function(e){this.palyAnim||this.headNode&&(this.headNode.eulerAngles=this.headAngle,this.neckNode.eulerAngles=this.neckNode.eulerAngles.add(this.neckAngle.clone()),this.bodyNode.eulerAngles=this.bodyNode.eulerAngles.add(this.bodyAngle.clone()))}},{key:"setMaterial",value:function(e,t,o,a){return new Promise((function(n,i){var s=new R,r={USE_NORMAL_MAP:!0,USE_ALBEDO_MAP:!0,USE_METALLIC_ROUGHNESS_MAP:!1};a&&(r={USE_NORMAL_MAP:!0,USE_ALBEDO_MAP:!0,USE_METALLIC_ROUGHNESS_MAP:!0}),s.initialize({effectAsset:e.effectAsset,defines:r,technique:a?1:0});for(var l=0;l<s.passes.length;l++)s.passes[l].blendState.isA2C=a;a?s.setProperty("metallic",.7):s.setProperty("metallic",0),s.setProperty("roughness",.7);var d=t+"/N/texture";Y.loadOneRes({url:d,type:S},(function(a,i){if(!a){s.setProperty("normalMap",i);var r=t+"/D/texture";Y.loadOneRes({url:r,type:S},(function(t,a){t?e.owner.setMaterial(s,o):(s.setProperty("mainTexture",a),e.owner.setMaterial(s,o),n(o))}))}}))}))}},{key:"loadRes",value:function(e,t){Y.loadOneRes(e,(function(e,o){t(e,o)}))}},{key:"onDestroy",value:function(){Y.clearCallBack(),U.off(O.EVT_CHANGEBG,this.onSetBg,this),U.off(O.EVT_GAMEINIT,this.initGame,this),U.off(O.EVT_HOTUPDATE,this.hotUpdate,this),U.off(O.EVT_BODYANIM,this.playRoleAnim,this),U.off(O.EVT_ROTATEROLE,this.onRotateRole,this),U.off(O.EVT_SCREENSHOT,this.onScreenShot,this),U.off(O.EVT_GETGAMEDATA,this.getGameData,this),U.off(O.EVT_CHANGEROLE,this.onChangleRole,this),U.off(O.EVT_ARKIT,this.onPlayRoleFaceAnim,this),U.off(O.EVT_BODYCHANGE,this.onChangeBodyPart,this),U.off(O.EVT_CHANGESROLECALE,this.onSetRoleScale,this),U.off(O.EVT_BODYCOLORCHANGE,this.onSetBodyPartColor,this),U.off(O.EVT_ALREADYUPTODATE,this.initData,this),this.node.off(f.EventType.TOUCH_MOVE,this.onTouchMove,this)}},{key:"onScreenShot",value:function(e){this.GUI.screenShot(e)}},{key:"getGameData",value:function(e){var t=JSON.parse(e).userdata,o=this.base64.base64encode(JSON.stringify(this.gameJson.data));("10001"==this.gameJson.data.role.id&&this.sex==E.Girl||"10002"==this.gameJson.data.role.id&&this.sex==E.Boy)&&(o=""),V.sendToNative("onGameDataFetched",{gamedata:o,userdata:t,sex:this.sex})}},{key:"onPlayRoleFaceAnim",value:function(e){var t=this;if(this.faceNode&&this.eyeBrowNode&&this.eyelashNode){clearTimeout(this.recoverFaceId),clearInterval(this.recoverHeadId);var o=M;if(ie&&(o=JSON.parse(e)),o){var a=this.faceNode.getComponent(H),n=this.eyeBrowNode.getComponent(H),i=this.eyelashNode.getComponent(H);48==a.weightsControl.length&&(a.weightsControl[47]=1);var s=function(e){var t=o.arFaceAnchors[e];if(J.hasOwnProperty(e)){var s=a.targetNames.findIndex((function(t){return t.split("_")[2]==J[e]}));-1!=s&&(a.weightsControl[s]=Number(t));var r=i.targetNames.findIndex((function(t){return t.split("_")[2]==J[e]}));-1!=r&&(i.weightsControl[r]=Number(t))}else if(D.hasOwnProperty(e)){var l=n.targetNames.findIndex((function(t){return t.split("_")[2]==D[e]}));if(-1!=l){var d=3*Number(t);d=A.clamp(d,0,1),n.weightsControl[l]=d}}};for(var r in o.arFaceAnchors)s(r);a.weightsControl=a.weightsControl,n.weightsControl=n.weightsControl,i.weightsControl=i.weightsControl;var l=Number(o.headPitch),d=Number(o.headYaw),h=Number(o.headRoll),c=d/Math.PI*180,g=h/Math.PI*180,u=l/Math.PI*180;c=A.clamp(c,-20,20),g=A.clamp(g,-20,20),u=A.clamp(u,-20,20),this.headAngle=new y(c,g,u),this.neckAngle=new y(.5*c,.5*g,.5*u),this.bodyAngle=new y(.2*c,.2*g,.2*u),this.recoverFaceId=setTimeout((function(){for(var e=0;e<a.weightsControl.length;e++)48!=e&&(a.weightsControl[e]=0);for(var o=0;o<n.weightsControl.length;o++)n.weightsControl[o]=0;for(var s=0;s<i.weightsControl.length;s++)i.weightsControl[s]=0;a.weightsControl=a.weightsControl,n.weightsControl=n.weightsControl,i.weightsControl=i.weightsControl;var r=new y(0,0,14),l=(new y(0,0,-6.317713),t.headAngle.clone().subtract(y.ZERO)),d=t.neckNode.eulerAngles.clone().subtract(r),h=t.neckNode.eulerAngles.clone().subtract(r),c=0;t.recoverHeadId=setInterval((function(){c>=10&&clearInterval(t.recoverHeadId),c++,t.headAngle.subtract(l.clone().multiplyScalar(.1)),t.neckAngle=d.clone().multiplyScalar(.1),t.bodyAngle=h.clone().multiplyScalar(.1),c>=10&&(t.neckAngle=y.ZERO,t.bodyAngle=y.ZERO)}),.1)}),1e3)}}}},{key:"onChangleRole",value:function(e){if(!this.isLoading){var t;if(""!=JSON.parse(e).roleBase64)t=JSON.parse(e).roleBase64,t=JSON.parse(this.base64.base64decode(t)),this.gameJson.data=t;else this.sex==E.Boy?this.gameJson.data=this.girlConfig:this.gameJson.data=this.boyConfig;this.sex=this.roleConfig[this.gameJson.data.role.id].sex,this.sex==E.Girl?this.mainCamera.node.setPosition(0,1.25,1.9):this.mainCamera.node.setPosition(0,1.35,1.9),this.onSetRoleScale(.5),this.GUI.slider.progress=.5,this.initRole(!1)}}},{key:"bgBtnClick",value:function(){this.onChangleRole(JSON.stringify({roleBase64:""}))}}]),t}(B)).prototype,"mainCamera",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=o(ee.prototype,"roleRootNode",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=ee))||$)),c._RF.pop()}}}));

System.register("chunks:///createJson.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./framework/config/localConfigMgr.js"],(function(e,t){var n,r,i,o,c,a,s,l,u,f,p,d,v,g,b,y,h,_,C,k;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){n=e.applyDecoratedDescriptor,r=e.inherits,i=e.classCallCheck,o=e.possibleConstructorReturn,c=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized,l=e.createClass},function(e){u=e.cclegacy,f=e._decorator,p=e.Node,d=e.Component},function(e){v=e.ConfigMgr}],execute:function(){u._RF.push({},"4c70dBYzwtAkLjDWq3k+2rP","createJson",void 0),C=f.ccclass,k=f.property,e("CreateJson",(g=C("CreateJson"),b=k(p),g((_=n((h=function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,l=new Array(r),u=0;u<r;u++)l[u]=arguments[u];return n=o(this,(e=c(t)).call.apply(e,[this].concat(l))),a(n,"btn",_,s(n)),n}return r(t,e),l(t,[{key:"start",value:function(){var e=this;this.btn.active=!1,v.loadConfig((function(){}),(function(){e.btn.active=!0}))}},{key:"create",value:function(){var e=v.getTable("role"),t=new Blob([JSON.stringify(e)],{type:"application/json"}),n=document.createElement("a");n.href=window.webkitURL.createObjectURL(t),n.download="",n.click()}}]),t}(d)).prototype,"btn",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=h))||y)),u._RF.pop()}}}));

System.register("chunks:///framework/DynamicBone/DynamicBonePlaneCollider.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./Pool.js","./Utils.js","./Plane.js","./Enums.js","./DynamicBoneColliderBase.js"],(function(t,e){var i,r,o,a,n,s,l,c,u,d,p,h,f,y,v,g,m,w,D,P,b,B,C,M,R,_,k,E,j,x,I,z,T,O;return t({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(t){i=t.applyDecoratedDescriptor,r=t.inherits,o=t.classCallCheck,a=t.possibleConstructorReturn,n=t.getPrototypeOf,s=t.initializerDefineProperty,l=t.assertThisInitialized,c=t.createClass},function(t){u=t.cclegacy,d=t._decorator,p=t.Vec3,h=t.director,f=t.Color,y=t.Quat,v=t.Mat4},function(t){g=t.Vec3Pool,m=t.Mat4Pool,w=t.QuatPool},function(t){D=t.rotate,P=t.rotateQ,b=t.transformDirection},function(t){B=t.Plane},function(t){C=t.EDirection,M=t.EBound},function(t){R=t.DynamicBoneColliderBase}],execute:function(){u._RF.push({},"5efd7qe0UlEdayur4DBIwDT","DynamicBonePlaneCollider",void 0),I=d.ccclass,z=d.property,T=d.executeInEditMode,d.disallowMultiple,t("DynamicBonePlaneCollider",(_=I("DynamicBonePlaneCollider"),k=z({tooltip:"显示半径"}),_(E=T((x=i((j=function(t){function e(){var t,i;o(this,e);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return i=a(this,(t=n(e)).call.apply(t,[this].concat(c))),s(i,"showRaduis",x,l(i)),i}return r(e,t),c(e,[{key:"debugDraw",value:function(){var t=h.root.pipeline.geometryRenderer;if(t){var e=0,i=g.get();switch(this.direction){case C.X:e=.5*-Math.PI,i.set(0,0,1);break;case C.Y:e=0;break;case C.Z:e=.5*Math.PI,i.set(1,0,0)}var r=m.get(),o=g.get(this.center);p.transformMat4(o,o,this.node.worldMatrix),D(r,i,e,o),this.applyRotation(r,o),t.addCircle(o,this.showRaduis,f.GREEN,8,!0,!0,r),g.put(i),g.put(o),m.put(r)}}},{key:"applyRotation",value:function(t,e){if(!this.rotate.equals3f(0,0,0)){var i=y.fromEuler(w.get(),this.rotate.x,this.rotate.y,this.rotate.z),r=m.get();P(r,i,e),v.multiply(t,r,t),w.put(i),m.put(r)}}},{key:"collide",value:function(t,e,i){this.ignoreTargetRadius&&(i=0);var r=g.get();switch(this.direction){case C.X:r.set(this.node.right);break;case C.Y:r.set(this.node.up);break;case C.Z:r.set(this.node.forward)}var o=g.get(),a=g.get();p.transformMat4(a,this.center,this.node.worldMatrix);var n=m.get();this.applyRotation(n,a),b(r,r,n);var s=m.get(this.node.worldMatrix);v.multiply(n,n,s),p.transformMat4(o,this.center,n),O.set(r,o);var l=O.getDistanceToPoint(e)+(this.bound===M.Outside?-i:i);return t.set(e),this.bound===M.Outside?l<0&&t.subtract(r.multiplyScalar(l)):l>0&&t.subtract(r.multiplyScalar(l)),m.put(n),m.put(s),g.put(o),g.put(a),g.put(r),t}}]),e}(R)).prototype,"showRaduis",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),E=j))||E)||E)),O=new B(new p(0,0,1),0),u._RF.pop()}}}));

System.register("chunks:///framework/DynamicBone/DynamicBoneSet.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc","./Enums.js","./DynamicBoneColliderBase.js","./DynamicBone.js"],(function(e,i){var t,r,o,n,a,s,c,l,d,u,p,b,f,v,y,g,_,m,D,w,z,h,C,O,j,B,x,N,R,A,T,k,I,S,E,F,G,P,H,K,L,M,U,Y,q,J,Q,V,W,X,Z,$,ee,ie,te,re,oe,ne,ae,se,ce,le,de,ue,pe,be,fe,ve,ye,ge,_e,me,De;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_dec7:void 0,_dec8:void 0,_dec9:void 0,_dec10:void 0,_dec11:void 0,_dec12:void 0,_dec13:void 0,_dec14:void 0,_dec15:void 0,_dec16:void 0,_dec17:void 0,_dec18:void 0,_dec19:void 0,_dec20:void 0,_dec21:void 0,_dec22:void 0,_dec23:void 0,_dec24:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_descriptor6:void 0,_descriptor7:void 0,_descriptor8:void 0,_descriptor9:void 0,_descriptor10:void 0,_descriptor11:void 0,_descriptor12:void 0,_descriptor13:void 0,_descriptor14:void 0,_descriptor15:void 0,_descriptor16:void 0,_descriptor17:void 0,_descriptor18:void 0,_descriptor19:void 0,_descriptor20:void 0,_descriptor21:void 0,_descriptor22:void 0,_descriptor23:void 0,_temp:void 0}),{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inherits,o=e.classCallCheck,n=e.possibleConstructorReturn,a=e.getPrototypeOf,s=e.initializerDefineProperty,c=e.assertThisInitialized,l=e.createClass,d=e.typeof},function(e){u=e.cclegacy,p=e._decorator,b=e.Node,f=e.CCInteger,v=e.CurveRange,y=e.CCFloat,g=e.v3,_=e.Component},function(e){m=e.EFreezeAxis},function(e){D=e.DynamicBoneColliderBase},function(e){w=e.DynamicBone}],execute:function(){u._RF.push({},"edd5fK954tC1rUr3tYks5Cp","DynamicBoneSet",void 0),ge=p.ccclass,_e=p.property,me=p.executeInEditMode,De=window.CC_EDITOR,e("DynamicBoneSet",(z=ge("DynamicBoneSet"),h=_e({type:[b],tooltip:"动态骨骼根节点集合"}),C=_e({type:f,tooltip:"刷新频率"}),O=_e({range:[0,1],tooltip:"阻尼"}),j=_e({type:v,tooltip:"阻尼变化曲线",range:[0,1]}),B=_e({range:[0,1],tooltip:"弹性"}),x=_e({type:v,tooltip:"弹性变化曲线",range:[0,1]}),N=_e({range:[0,1],tooltip:"硬度"}),R=_e({type:v,tooltip:"硬度变化曲线",range:[0,1]}),A=_e({range:[0,1],tooltip:"惰性"}),T=_e({type:v,tooltip:"惰性变化曲线",range:[0,1]}),k=_e({type:y,tooltip:"碰撞半径"}),I=_e({type:v,tooltip:"碰撞半径变化曲线",range:[0,1]}),S=_e({type:[b],tooltip:"尾部延长节点"}),E=_e({tooltip:"末尾节点偏移量"}),F=_e({tooltip:"世界坐标下的重力"}),G=_e({tooltip:"常驻外力"}),P=_e({type:m,tooltip:"冻结平面轴"}),H=_e({type:[D],tooltip:"碰撞器"}),K=_e({type:[b],tooltip:"排除当前节点及其子节点"}),L=_e({tooltip:"是否开启物理模拟距离测试，默认相对于相机"}),M=_e({type:b,tooltip:"用于相对距离测试计算"}),U=_e({tooltip:"距离测试阈值"}),Y=_e({tooltip:"是否显示调试图形"}),z(q=me((Q=t((J=function(e){function i(){var e,t;o(this,i);for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return t=n(this,(e=a(i)).call.apply(e,[this].concat(l))),s(t,"roots",Q,c(t)),s(t,"updateRate",V,c(t)),s(t,"damping",W,c(t)),s(t,"dampingDistrib",X,c(t)),s(t,"elasticity",Z,c(t)),s(t,"elasticityDistrib",$,c(t)),s(t,"stiffness",ee,c(t)),s(t,"stiffnessDistrib",ie,c(t)),s(t,"inert",te,c(t)),s(t,"inertDistrib",re,c(t)),s(t,"radius",oe,c(t)),s(t,"radiusDistrib",ne,c(t)),s(t,"endNodes",ae,c(t)),s(t,"endOffsets",se,c(t)),s(t,"gravity",ce,c(t)),s(t,"force",le,c(t)),s(t,"freezeAxis",de,c(t)),s(t,"colliders",ue,c(t)),s(t,"excludeNodes",pe,c(t)),s(t,"distantDisable",be,c(t)),s(t,"refenceObject",fe,c(t)),s(t,"distanceToObject",ve,c(t)),s(t,"showDebugGizmos",ye,c(t)),t._dynamicBones=[],t}return r(i,e),l(i,[{key:"onLoad",value:function(){var e=this;if(!De)for(var i=this.node.getComponents(w),t=function(t){var r=e.roots[t];if(!r)return{v:void 0};var o=i.findIndex((function(e){return e.root==r})),n=o>=0?i[o]:e.node.addComponent(w);n.root=r,n.updateRate=e.updateRate,n.damping=e.damping,n.dampingDistrib=e.dampingDistrib,n.elasticity=e.elasticity,n.elasticityDistrib=e.elasticityDistrib,n.stiffness=e.stiffness,n.stiffnessDistrib=e.stiffnessDistrib,n.inert=e.inert,n.inertDistrib=e.inertDistrib,n.radius=e.radius,n.radiusDistrib=e.radiusDistrib,n.endNode=e.endNodes.length>t?e.endNodes[t]:null,n.endOffset=e.endOffsets.length>t?e.endOffsets[t]:g(),n.gravity=e.gravity,n.force=e.force,n.freezeAxis=e.freezeAxis,n.colliders=e.colliders,n.excludeNodes=e.excludeNodes,n.distantDisable=e.distantDisable,n.refenceObject=e.refenceObject,n.distanceToObject=e.distanceToObject,n.showDebugGizmos=e.showDebugGizmos,n.initial(),e._dynamicBones.push(n)},r=0;r<this.roots.length;r++){var o=t(r);if("object"===d(o))return o.v}}}]),i}(_)).prototype,"roots",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=t(J.prototype,"updateRate",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 60}}),W=t(J.prototype,"damping",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),X=t(J.prototype,"dampingDistrib",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v}}),Z=t(J.prototype,"elasticity",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),$=t(J.prototype,"elasticityDistrib",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v}}),ee=t(J.prototype,"stiffness",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),ie=t(J.prototype,"stiffnessDistrib",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v}}),te=t(J.prototype,"inert",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),re=t(J.prototype,"inertDistrib",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v}}),oe=t(J.prototype,"radius",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ne=t(J.prototype,"radiusDistrib",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v}}),ae=t(J.prototype,"endNodes",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),se=t(J.prototype,"endOffsets",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ce=t(J.prototype,"gravity",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g()}}),le=t(J.prototype,"force",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g()}}),de=t(J.prototype,"freezeAxis",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return m.None}}),ue=t(J.prototype,"colliders",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),pe=t(J.prototype,"excludeNodes",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),be=t(J.prototype,"distantDisable",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fe=t(J.prototype,"refenceObject",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ve=t(J.prototype,"distanceToObject",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),ye=t(J.prototype,"showDebugGizmos",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),q=J))||q)||q)),u._RF.pop()}}}));

System.register("chunks:///framework/ui/Loading.js",["../../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var n,r,o,i,c,s,a,u,l,p,d,f,g,h;return e({_dec:void 0,_class:void 0}),{setters:[function(e){n=e.inherits,r=e.createClass,o=e.classCallCheck,i=e.possibleConstructorReturn,c=e.getPrototypeOf},function(e){s=e.cclegacy,a=e._decorator,u=e.find,l=e.tween,p=e.Vec3,d=e.Component}],execute:function(){s._RF.push({},"c27e6e7UWZEEZ616Oe7/tZ7","Loading",void 0),h=a.ccclass,a.property,e("Loading",(f=h("Loading"),f(g=function(e){function t(){return o(this,t),i(this,c(t).apply(this,arguments))}return n(t,e),r(t,[{key:"start",value:function(){var e=u("loading_circle",this.node);l(e).by(1,{eulerAngles:new p(0,0,360)}).repeatForever().union().start()}}]),t}(d))||g)),s._RF.pop()}}}));

System.register("chunks:///headMorph.js",["./_virtual/_rollupPluginBabelHelpers.js","cc"],(function(t,e){var o,r,i,n,s,h,l,a,p,u,c,d,g,m,v,f,_,y,C,b,w,M,k,I,L,P,H,D,T,z,E,N;return t({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(t){o=t.applyDecoratedDescriptor,r=t.inherits,i=t.classCallCheck,n=t.possibleConstructorReturn,s=t.getPrototypeOf,h=t.initializerDefineProperty,l=t.assertThisInitialized,a=t.createClass},function(t){p=t.cclegacy,u=t._decorator,c=t.Node,d=t.Layout,g=t.CCFloat,m=t.MeshRenderer,v=t.instantiate,f=t.find,_=t.Label,y=t.Slider,C=t.EventHandler,b=t.Component}],execute:function(){p._RF.push({},"c0aafsHUcJNb6ftp5LVohdy","headMorph",void 0),z=u.ccclass,E=u.property,N=u.executeInEditMode,t("HeadMorph",(w=z("HeadMorph"),M=N(),k=E({type:c}),I=E({type:d}),L=E({type:[g],range:[0,1,.1],slide:!0}),w(P=M((D=o((H=function(t){function e(){var t,o;i(this,e);for(var r=arguments.length,a=new Array(r),p=0;p<r;p++)a[p]=arguments[p];return(o=n(this,(t=s(e)).call.apply(t,[this].concat(a))))._weightsControl=[],o._modelComp=null,o._totalTargets=0,h(o,"controlItemPrfb",D,l(o)),h(o,"itemLayout",T,l(o)),o}return r(e,t),a(e,[{key:"setWeights",value:function(t){if(0!==t.length)for(var e=0;e<this._morph.subMeshMorphs.length;++e)this._morph.subMeshMorphs[e]&&this._modelComp.setWeights(t,e)}},{key:"start",value:function(){if(this._modelComp=this.node.getComponent(m),this._modelComp){var t=this._modelComp.mesh;if(t&&(this._morph=t.struct.morph,this._morph))if(0!==this._morph.subMeshMorphs.length){var e=this._morph.subMeshMorphs.find((function(t){return!!t}));if(e){this._morph.subMeshMorphs.every((function(t){return!t||t.targets.length===e.targets.length}))||console.warn("not all submesh count are the same");var o=this._morph.subMeshMorphs[0],r=o?o.targets.length:0;this._totalTargets=r,this.weightsControl=new Array(r).fill(0),this.initUI()}else console.warn("all submesh don't have morph")}else console.warn("submesh count is 0")}}},{key:"initUI",value:function(){this.itemLayout.node.removeAllChildren();for(var t=0;t<this._totalTargets;t++){var e,o=v(this.controlItemPrfb);o.active=!0,o.parent=this.itemLayout.node;var r=null===(e=f("Name",o))||void 0===e?void 0:e.getComponent(_);r&&(r.string=""+t);var i=null==o?void 0:o.getComponent(y),n=new C;n.target=this.node,n.handler="onSliderChanged",n.component="HeadMorph",n.customEventData=""+t,null==i||i.slideEvents.push(n)}}},{key:"onSliderChanged",value:function(t,e){var o=Number.parseInt(e);this.weightsControl[o]=t.progress,this.weightsControl=this.weightsControl}},{key:"update",value:function(t){}},{key:"weightsControl",get:function(){return this._weightsControl},set:function(t){t.length==this._totalTargets&&(this._weightsControl=t,this.setWeights(this._weightsControl))}}]),e}(b)).prototype,"controlItemPrfb",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=o(H.prototype,"itemLayout",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o(H.prototype,"weightsControl",[L],Object.getOwnPropertyDescriptor(H.prototype,"weightsControl"),H.prototype),P=H))||P)||P)),p._RF.pop()}}}));

System.register("chunks:///utils/LocalDataUtil.js",["../_virtual/_rollupPluginBabelHelpers.js","cc"],(function(e,t){var l,a,c,n,u,o;return{setters:[function(e){l=e.createClass,a=e.classCallCheck},function(e){c=e.cclegacy,n=e.log,u=e.sys}],execute:function(){c._RF.push({},"75e8c7Eo4BGp4im/K0PUDUi","LocalDataUtil",void 0),o=function(){function e(){a(this,e)}return l(e,null,[{key:"setItem",value:function(e,t){null!=t?(u.localStorage.setItem(e,JSON.stringify(t)),n("setItem key = ".concat(e,"  value = ").concat(t))):n("setItem value is null")}},{key:"getItem",value:function(e){var t=u.localStorage.getItem(e);return t?JSON.parse(t):null}},{key:"removeItem",value:function(e){u.localStorage.removeItem(e)}},{key:"clearItem",value:function(){u.localStorage.clear()}}]),e}(),c._RF.pop(),e("default",o)}}}));

System.register("chunks:///utils/MyUtils.js",["../_virtual/_rollupPluginBabelHelpers.js","cc","./EngineUtil.js","./LocalDataUtil.js"],(function(t,e){var n,c,r,u,i,l,o;return{setters:[function(t){n=t.createClass,c=t.classCallCheck},function(t){r=t.cclegacy},function(t){u=t.default},function(t){i=t.default}],execute:function(){r._RF.push({},"49020AsBhpALp3pQpxOlEU/","MyUtils",void 0),l={object:"[object Object]",array:"[object Array]",function:"[object Function]",number:"[object Number]",string:"[object String]",null:"[object Null]",undefined:"[object Undefined]"},(o=function(){function t(){c(this,t)}return n(t,null,[{key:"isObject",value:function(t){return Object.prototype.toString.call(t)===l.object}},{key:"isArray",value:function(t){return Object.prototype.toString.call(t)===l.array}},{key:"isFunction",value:function(t){return Object.prototype.toString.call(t)===l.function}},{key:"isNumber",value:function(t){return Object.prototype.toString.call(t)===l.number}},{key:"isString",value:function(t){return Object.prototype.toString.call(t)===l.string}},{key:"isNull",value:function(t){return Object.prototype.toString.call(t)===l.null}},{key:"isUndefined",value:function(t){return Object.prototype.toString.call(t)===l.undefined}}]),t}()).EngineUtil=u,o.LocalDataUtil=i,r._RF.pop(),t("default",o)}}}));

System.register("chunks:///index.js",["cc","./utils/MyUtils.js"],(function(e,n){var t,i,s;return{setters:[function(e){t=e.cclegacy},function(e){i=e.default}],execute:function(){t._RF.push({},"e9503zNVEBIF7Y+N+nOAU5T","index",void 0),(s="undefined"==typeof window?global:window).MyUtils=s.MyUtils||{},MyUtils=i,t._RF.pop()}}}));

System.register("chunks:///typescript.js",["./_virtual/_rollupPluginBabelHelpers.js","cc","./framework/manager/AssetsManager.js"],(function(e,t){var r,i,n,o,l,a,s,c,u,p,d,f,h,y,_,m,v,b,C,g,M,A,k,S,P,w,R,O,z,E,x,D,T,j,L,N,U;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(e){r=e.applyDecoratedDescriptor,i=e.inherits,n=e.classCallCheck,o=e.possibleConstructorReturn,l=e.getPrototypeOf,a=e.initializerDefineProperty,s=e.assertThisInitialized,c=e.createClass},function(e){u=e.cclegacy,p=e._decorator,d=e.Node,f=e.SkeletalAnimationComponent,h=e.Mesh,y=e.SpriteFrame,_=e.loader,m=e.ModelComponent,v=e.director,b=e.Prefab,C=e.instantiate,g=e.MeshRenderer,M=e.Material,A=e.Texture2D,k=e.Component},function(e){S=e.AM}],execute:function(){u._RF.push({},"f7397SqfNRCOYj+AQWqAEZY","typescript",void 0),N=p.ccclass,U=p.property,e("Typescript",(P=N("Typescript"),w=U(d),R=U(f),O=U(h),z=U(y),P((D=r((x=function(e){function t(){var e,r;n(this,t);for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];return r=o(this,(e=l(t)).call.apply(e,[this].concat(c))),a(r,"role",D,s(r)),a(r,"roleModel",T,s(r)),a(r,"mesh",j,s(r)),a(r,"sp",L,s(r)),r.r=null,r.m=null,r}return i(t,e),c(t,[{key:"onLoad",value:function(){console.log(Object.keys(_._cache).length)}},{key:"btnClick",value:function(){this.r=new d("a"),this.r.addComponent(m),this.r.getComponent(m).mesh=this.mesh,v.getScene().addChild(this.r)}},{key:"btnClick2",value:function(){this.r.destroy(),this.r=null}},{key:"btnClick3",value:function(){var e=this;_.loadRes("prefab/female_top_30002",b,(function(t,r){e.m=r,e.r=C(r);var i=e.r.getComponentInChildren(g).materials[0];e.setMaterial(i,"textures/female_top_30002",0,!0),v.getScene().addChild(e.r)}))}},{key:"setMaterial",value:function(e,t,r,i){var n=new M;n.initialize({effectAsset:e.effectAsset,defines:{USE_NORMAL_MAP:!0,USE_ALBEDO_MAP:!0,USE_METALLIC_ROUGHNESS_MAP:!0}}),n.setProperty("metallic",0),n.setProperty("roughness",.7);var o=t+"/N/texture";S.loadOneRes({url:o,type:A},(function(i,o){if(!i){n.setProperty("normalMap",o);var l=t+"/D/texture";S.loadOneRes({url:l,type:A},(function(t,i){t?e.owner.setMaterial(n,r):(n.passes[0].blendState.isA2C=!0,n.setProperty("mainTexture",i),e.owner.setMaterial(n,r))}))}}))}}]),t}(k)).prototype,"role",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=r(x.prototype,"roleModel",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=r(x.prototype,"mesh",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=r(x.prototype,"sp",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=x))||E)),u._RF.pop()}}}));

System.register("chunks:///_virtual/prerequisite-imports:main",["../Define.js","../framework/base64.js","../framework/event/clientEvent.js","../framework/sdk/SDK.js","../morphContrl.js","../framework/data/GlobalData.js","../framework/logger.js","../hotupdate/HotUpdate.js","../framework/manager/AssetsManager.js","../utils/EngineUtil.js","../framework/manager/CsvManager.js","../framework/config/localConfigMgr.js","../framework/ui/selectBodyPartStyle.js","../ImageDownLoad.js","../GUI.js","../framework/DynamicBone/Particle.js","../framework/DynamicBone/DynamicBoneSettings.js","../framework/DynamicBone/Pool.js","../framework/DynamicBone/Utils.js","../framework/DynamicBone/Plane.js","../framework/DynamicBone/Enums.js","../framework/DynamicBone/DynamicBoneColliderBase.js","../framework/DynamicBone/DynamicBone.js","../framework/DynamicBone/DynamicBoneCollider.js","../DynamicBoneComp.js","../AvatarMgr.js","../createJson.js","../framework/DynamicBone/DynamicBonePlaneCollider.js","../framework/DynamicBone/DynamicBoneSet.js","../framework/ui/Loading.js","../headMorph.js","../utils/LocalDataUtil.js","../utils/MyUtils.js","../index.js","../typescript.js"],(function(n,o){return{setters:[function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){},function(n){}],execute:function(){}}}));

(function(r) {
  r('project:///assets/scripts/Define.js', 'chunks:///Define.js');
  r('project:///assets/scripts/framework/base64.js', 'chunks:///framework/base64.js');
  r('project:///assets/scripts/framework/event/clientEvent.js', 'chunks:///framework/event/clientEvent.js');
  r('project:///assets/scripts/framework/sdk/SDK.js', 'chunks:///framework/sdk/SDK.js');
  r('project:///assets/scripts/morphContrl.js', 'chunks:///morphContrl.js');
  r('project:///assets/scripts/framework/data/GlobalData.js', 'chunks:///framework/data/GlobalData.js');
  r('project:///assets/scripts/framework/logger.js', 'chunks:///framework/logger.js');
  r('project:///assets/scripts/hotupdate/HotUpdate.js', 'chunks:///hotupdate/HotUpdate.js');
  r('project:///assets/scripts/framework/manager/AssetsManager.js', 'chunks:///framework/manager/AssetsManager.js');
  r('project:///assets/scripts/utils/EngineUtil.js', 'chunks:///utils/EngineUtil.js');
  r('project:///assets/scripts/framework/manager/CsvManager.js', 'chunks:///framework/manager/CsvManager.js');
  r('project:///assets/scripts/framework/config/localConfigMgr.js', 'chunks:///framework/config/localConfigMgr.js');
  r('project:///assets/scripts/framework/ui/selectBodyPartStyle.js', 'chunks:///framework/ui/selectBodyPartStyle.js');
  r('project:///assets/scripts/ImageDownLoad.js', 'chunks:///ImageDownLoad.js');
  r('project:///assets/scripts/GUI.js', 'chunks:///GUI.js');
  r('project:///assets/scripts/framework/DynamicBone/Particle.js', 'chunks:///framework/DynamicBone/Particle.js');
  r('project:///assets/scripts/framework/DynamicBone/DynamicBoneSettings.js', 'chunks:///framework/DynamicBone/DynamicBoneSettings.js');
  r('project:///assets/scripts/framework/DynamicBone/Pool.js', 'chunks:///framework/DynamicBone/Pool.js');
  r('project:///assets/scripts/framework/DynamicBone/Utils.js', 'chunks:///framework/DynamicBone/Utils.js');
  r('project:///assets/scripts/framework/DynamicBone/Plane.js', 'chunks:///framework/DynamicBone/Plane.js');
  r('project:///assets/scripts/framework/DynamicBone/Enums.js', 'chunks:///framework/DynamicBone/Enums.js');
  r('project:///assets/scripts/framework/DynamicBone/DynamicBoneColliderBase.js', 'chunks:///framework/DynamicBone/DynamicBoneColliderBase.js');
  r('project:///assets/scripts/framework/DynamicBone/DynamicBone.js', 'chunks:///framework/DynamicBone/DynamicBone.js');
  r('project:///assets/scripts/framework/DynamicBone/DynamicBoneCollider.js', 'chunks:///framework/DynamicBone/DynamicBoneCollider.js');
  r('project:///assets/scripts/DynamicBoneComp.js', 'chunks:///DynamicBoneComp.js');
  r('project:///assets/scripts/AvatarMgr.js', 'chunks:///AvatarMgr.js');
  r('project:///assets/scripts/createJson.js', 'chunks:///createJson.js');
  r('project:///assets/scripts/framework/DynamicBone/DynamicBonePlaneCollider.js', 'chunks:///framework/DynamicBone/DynamicBonePlaneCollider.js');
  r('project:///assets/scripts/framework/DynamicBone/DynamicBoneSet.js', 'chunks:///framework/DynamicBone/DynamicBoneSet.js');
  r('project:///assets/scripts/framework/ui/Loading.js', 'chunks:///framework/ui/Loading.js');
  r('project:///assets/scripts/headMorph.js', 'chunks:///headMorph.js');
  r('project:///assets/scripts/utils/LocalDataUtil.js', 'chunks:///utils/LocalDataUtil.js');
  r('project:///assets/scripts/utils/MyUtils.js', 'chunks:///utils/MyUtils.js');
  r('project:///assets/scripts/index.js', 'chunks:///index.js');
  r('project:///assets/scripts/typescript.js', 'chunks:///typescript.js');
  r('virtual:///prerequisite-imports:main', 'chunks:///_virtual/prerequisite-imports:main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    var _m;
    return {
        setters: [function(m) { _m = m; }],
        execute: function () { _export(_m); }
    };
    });
});
} }; });