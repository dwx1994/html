System.register(["./deprecated-fd5a8e75.js","./deprecated-9a4df5e2.js"],(function(t){"use strict";var e,i,n,r,s,h,a,f;return{setters:[function(t){e=t.d,i=t.c,n=t.b,r=t.e,s=t.f,h=t.j,a=t.l,f=t.aC},function(){}],execute:function(){t("j",4),t("k",4),t("d",256);var l,u=t("b",32),o=(t("a",33),t("c",8),t("h",32768)),g=t("i",1/512),y=(t("g",-o*g),t("f",(65535-o)*g),t("l",0),t("m",1),t("n",2),t("o",3),t("p",16842753)),_=t("q",16842754),c=t("r",16842755),w=t("s",16843025),v=function(){function t(){e(this,t),this.length=0,this.buffer=new Uint8Array(2048),this._buffView=new DataView(this.buffer.buffer),this._seekPos=0}return h(t,[{key:"reserve",value:function(t){if(!(this.buffer.byteLength>t)){for(var e=this.buffer.byteLength;e<t;)e+=e;for(var i=new Uint8Array(e),n=0;n<this.length;++n)i[n]=this.buffer[n];this.buffer=i,this._buffView=new DataView(this.buffer.buffer)}}},{key:"assign",value:function(t){this.buffer=t,this.length=t.length,this._seekPos=t.byteOffset,this._buffView=new DataView(t.buffer)}},{key:"writeInt8",value:function(t){this.reserve(this.length+1),this._buffView.setInt8(this.length,t),this.length+=1}},{key:"writeInt16",value:function(t){this.reserve(this.length+2),this._buffView.setInt16(this.length,t,!0),this.length+=2}},{key:"writeInt32",value:function(t){this.reserve(this.length+4),this._buffView.setInt32(this.length,t,!0),this.length+=4}},{key:"writeIntArray",value:function(t){this.reserve(this.length+4*t.length);for(var e=0;e<t.length;++e)this._buffView.setInt32(this.length+4*e,t[e],!0);this.length+=4*t.length}},{key:"writeFloat",value:function(t){this.reserve(this.length+4),this._buffView.setFloat32(this.length,t,!0),this.length+=4}},{key:"writeFloatArray",value:function(t){this.reserve(this.length+4*t.length);for(var e=0;e<t.length;++e)this._buffView.setFloat32(this.length+4*e,t[e],!0);this.length+=4*t.length}},{key:"writeString",value:function(t){this.reserve(this.length+t.length+4),this._buffView.setInt32(this.length,t.length,!0);for(var e=0;e<t.length;++e)this._buffView.setInt8(this.length+4+e,t.charCodeAt(e));this.length+=t.length+4}},{key:"readInt8",value:function(){var t=this._buffView.getInt8(this._seekPos);return this._seekPos+=1,t}},{key:"readInt16",value:function(){var t=this._buffView.getInt16(this._seekPos,!0);return this._seekPos+=2,t}},{key:"readInt",value:function(){var t=this._buffView.getInt32(this._seekPos,!0);return this._seekPos+=4,t}},{key:"readIntArray",value:function(t){for(var e=0;e<t.length;++e)t[e]=this._buffView.getInt32(this._seekPos+4*e,!0);return this._seekPos+=4*t.length,t}},{key:"readFloat",value:function(){var t=this._buffView.getFloat32(this._seekPos,!0);return this._seekPos+=4,t}},{key:"readFloatArray",value:function(t){for(var e=0;e<t.length;++e)t[e]=this._buffView.getFloat32(this._seekPos+4*e,!0);return this._seekPos+=4*t.length,t}},{key:"readString",value:function(){for(var t=this.readInt(),e="",i=0;i<t;++i)e+=String.fromCharCode(this.readInt8());return e}}]),t}(),k=t("e",(function t(){e(this,t),this.slot=0,this.tileSize=1,this.detailMap=""}));t("T",i("cc.TerrainAsset")(l=function(t){function i(){var t;return e(this,i),(t=r(this,s(i).call(this)))._data=null,t._tileSize=1,t._blockCount=[1,1],t._weightMapSize=128,t._lightMapSize=128,t._heights=new Uint16Array,t._weights=new Uint8Array,t._layerBuffer=[-1,-1,-1,-1],t._layerInfos=[],t.loaded=!1,t}return n(i,t),h(i,[{key:"getLayer",value:function(t,e,i){var n=4*(e*this.blockCount[0]+t)+i;return t<this.blockCount[0]&&e<this.blockCount[1]&&n<this._layerBuffer.length?this._layerBuffer[n]:-1}},{key:"getHeight",value:function(t,e){var i=this._blockCount[0]*u+1;return(this._heights[e*i+t]-o)*g}},{key:"getVertexCountI",value:function(){return this._blockCount.length<1?0:this._blockCount[0]*u+1}},{key:"getVertexCountJ",value:function(){return this._blockCount.length<2?0:this._blockCount[1]*u+1}},{key:"_setNativeData",value:function(t){this._data=t}},{key:"_loadNativeData",value:function(t){var e=new v;e.assign(t);var i=e.readInt();if(i===w)return!0;if(i!==y&&i!==_&&i!==c)return!1;this.tileSize=e.readFloat(),e.readIntArray(this._blockCount),this.weightMapSize=e.readInt16(),this.lightMapSize=e.readInt16();var n=e.readInt();this.heights=new Uint16Array(n);for(var r=0;r<this.heights.length;++r)this.heights[r]=e.readInt16();var s=e.readInt();this.weights=new Uint8Array(s);for(var h=0;h<this.weights.length;++h)this.weights[h]=e.readInt8();if(i>=_){var a=e.readInt();this.layerBuffer=new Array(a);for(var f=0;f<this.layerBuffer.length;++f)this.layerBuffer[f]=e.readInt16()}if(i>=c){var l=e.readInt();this.layerInfos=new Array(l);for(var u=0;u<this.layerInfos.length;++u)this.layerInfos[u]=new k,this.layerInfos[u].slot=e.readInt(),this.layerInfos[u].tileSize=e.readFloat(),this.layerInfos[u].detailMap=e.readString()}return!0}},{key:"_exportNativeData",value:function(){var t=new v;t.writeInt32(c),t.writeFloat(this.tileSize),t.writeIntArray(this._blockCount),t.writeInt16(this.weightMapSize),t.writeInt16(this.lightMapSize),t.writeInt32(this.heights.length);for(var e=0;e<this.heights.length;++e)t.writeInt16(this.heights[e]);t.writeInt32(this.weights.length);for(var i=0;i<this.weights.length;++i)t.writeInt8(this.weights[i]);t.writeInt32(this.layerBuffer.length);for(var n=0;n<this.layerBuffer.length;++n)t.writeInt16(this.layerBuffer[n]);t.writeInt32(this.layerInfos.length);for(var r=0;r<this.layerInfos.length;++r)t.writeInt32(this.layerInfos[r].slot),t.writeFloat(this.layerInfos[r].tileSize),t.writeString(this.layerInfos[r].detailMap);return t.buffer}},{key:"_exportDefaultNativeData",value:function(){var t=new v;return t.writeInt32(w),t.buffer}},{key:"_nativeAsset",get:function(){return this._data.buffer},set:function(t){this._data&&this._data.byteLength===t.byteLength?(this._data.set(new Uint8Array(t)),a.loader._cache[this.nativeUrl]&&(a.loader._cache[this.nativeUrl].content=this._data.buffer)):this._data=new Uint8Array(t),this._loadNativeData(this._data),this.loaded=!0,this.emit("load")}},{key:"tileSize",set:function(t){this._tileSize=t},get:function(){return this._tileSize}},{key:"blockCount",set:function(t){this._blockCount=t},get:function(){return this._blockCount}},{key:"lightMapSize",set:function(t){this._lightMapSize=t},get:function(){return this._lightMapSize}},{key:"weightMapSize",set:function(t){this._weightMapSize=t},get:function(){return this._weightMapSize}},{key:"heights",set:function(t){this._heights=t},get:function(){return this._heights}},{key:"weights",set:function(t){this._weights=t},get:function(){return this._weights}},{key:"layerBuffer",set:function(t){this._layerBuffer=t},get:function(){return this._layerBuffer}},{key:"layerInfos",set:function(t){this._layerInfos=t},get:function(){return this._layerInfos}}]),i}(f))||l)}}}));
